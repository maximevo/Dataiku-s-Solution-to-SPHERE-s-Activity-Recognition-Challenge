# -*- coding: utf-8 -*-
import numpy as np
import pandas as pd
import sklearn as sk
from collections import defaultdict, Counter
import xgboost as xgb
import os

#######
# The goal of this section of code is to find the best parameters (gridsearch) for an xgboost model that predicts the target.
# We gridsearch several parameters. When the best parameters are found, they are printed in the logs: look for the last 'mybestmodel' in the logs to find the optimal parameters
#######

input_path = os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(__file__))), 'data/processed/columns_train_with_feature_engineering.csv')
ml_dataset = pd.read_csv(filepath_or_buffer = input_path,encoding='utf-8')


# Keep some useful info
cv_df=ml_dataset[['original_dataset']]

columns_target=['a_ascend','a_descend','a_jump','a_loadwalk','a_walk','p_bent','p_kneel','p_lie','p_sit','p_squat','p_stand','t_bend',
               't_kneel_stand','t_lie_sit','t_sit_lie','t_sit_stand','t_stand_kneel','t_stand_sit','t_straighten','t_turn']
columns_to_keep = ['time_since_change_of_record_id','time_since_change_of_video_room',u'video_room_centre_2d_y_mean', u'video_room_centre_2d_y_length_lag_10', u'rssi_Kitchen_AP_min', u'video_room_bb_3d_flt_z_median_lag_10', u'rssi_Lounge_AP_max', u'video_room_bb_3d_flt_x_min_lag_10', u'acceleration_x_std_lag_9', u'acceleration_x_std_lag_8', u'acceleration_x_std_lag_3', u'acceleration_x_std_lag_2', u'acceleration_x_std_lag_1', u'acceleration_x_std_lag_7', u'acceleration_x_std_lag_6', u'acceleration_x_std_lag_5', u'acceleration_x_std_lag_4', u'rssi_Study_AP_mean_lag_10', u'acceleration_y_min_lag_10', u'video_room_centre_3d_x_min', u'video_room_centre_3d_x_median_lag_10', u'video_room_centre_2d_x_median_lag_8', u'probability_of_value_hall_bas_lag_10', u'rssi_Kitchen_AP_std_lag_9', u'rssi_Kitchen_AP_std_lag_8', u'rssi_Kitchen_AP_std_lag_3', u'rssi_Kitchen_AP_std_lag_2', u'rssi_Kitchen_AP_std_lag_1', u'rssi_Kitchen_AP_std_lag_7', u'rssi_Kitchen_AP_std_lag_6', u'rssi_Kitchen_AP_std_lag_5', u'rssi_Kitchen_AP_std_lag_4', u'video_room_centre_3d_x_mean_lagdiff_lagdiff', u'video_room_centre_2d_y_max_lag_10', u'video_room_bb_2d_br_x_mean_lag_3', u'video_room_bb_2d_br_x_mean_lag_2', u'video_room_bb_2d_br_x_mean_lag_1', u'video_room_bb_2d_br_x_mean_lag_7', u'video_room_bb_2d_br_x_mean_lag_6', u'video_room_bb_2d_br_x_mean_lag_5', u'video_room_bb_2d_br_x_mean_lag_4', u'video_room_bb_2d_br_x_mean_lag_9', u'video_room_bb_2d_br_x_mean_lag_8', u'acceleration_z_std_lag_1', u'video_room_bb_3d_brb_z_max', u'acceleration_y_mean_lag_9', u'acceleration_y_mean_lag_8', u'video_room_bb_3d_flt_y_min_lag_7', u'acceleration_y_mean', u'video_room_centre_3d_y_median_lag_1', u'video_room_bb_3d_flt_y_median_lag_9', u'video_room_bb_3d_flt_y_median_lag_8', u'video_room_bb_3d_flt_y_median_lag_5', u'video_room_bb_3d_flt_y_median_lag_4', u'video_room_bb_3d_flt_y_median_lag_7', u'video_room_bb_3d_flt_y_median_lag_6', u'video_room_bb_3d_flt_y_median_lag_1', u'video_room_bb_3d_flt_y_median_lag_3', u'video_room_bb_3d_flt_y_median_lag_2', u'video_room_bb_3d_brb_z_std_lag_10', u'video_room_centre_3d_z_median_lag_10', u'video_room_bb_3d_flt_y_min_lag_1', u'acceleration_y_mean_lag_5', u'acceleration_y_mean_lag_4', u'video_room_bb_3d_brb_x_length', u'rssi_Upstairs_AP_mean_lag_8', u'rssi_Upstairs_AP_mean_lag_9', u'rssi_Upstairs_AP_mean_lag_7', u'rssi_Upstairs_AP_mean_lag_4', u'rssi_Upstairs_AP_mean_lag_5', u'rssi_Upstairs_AP_mean_lag_2', u'rssi_Upstairs_AP_mean_lag_3', u'rssi_Upstairs_AP_mean_lag_1', u'video_room_centre_3d_x_std_lag_8', u'video_room_centre_3d_x_std_lag_9', u'video_room_bb_3d_flt_x_std', u'video_room_centre_3d_x_std_lag_2', u'video_room_centre_3d_x_std_lag_3', u'video_room_centre_3d_x_std_lag_1', u'video_room_centre_3d_x_std_lag_6', u'video_room_centre_3d_x_std_lag_7', u'video_room_centre_3d_x_std_lag_4', u'video_room_centre_3d_x_std_lag_5', u'video_room_centre_2d_x_min', u'video_room_bb_3d_brb_z_std_lag_8', u'video_room_bb_3d_brb_x_length_lag_5', u'rssi_Study_AP_median', u'video_room_bb_3d_brb_y_std_lag_7', u'video_room_bb_3d_flt_y_std_lag_10', u'video_room_bb_2d_br_y_median_lag_7', u'video_room_bb_2d_br_y_median_lag_6', u'video_room_bb_2d_br_y_median_lag_5', u'video_room_bb_2d_br_y_median_lag_4', u'video_room_bb_2d_br_y_median_lag_3', u'video_room_bb_2d_br_y_median_lag_2', u'video_room_bb_2d_br_y_median_lag_1', u'video_room_bb_3d_brb_z_std_lag_4', u'video_room_bb_2d_br_y_median_lag_9', u'video_room_bb_3d_brb_z_std_lag_5', u'video_room_bb_3d_brb_x_std_lag_10', u'video_room_bb_2d_tl_y_median_lag_9', u'video_room_bb_2d_tl_y_median_lag_8', u'video_room_bb_2d_tl_y_median_lag_3', u'video_room_bb_2d_tl_y_median_lag_2', u'video_room_bb_2d_tl_y_mean', u'video_room_bb_2d_tl_y_median_lag_7', u'video_room_bb_2d_tl_y_median_lag_6', u'video_room_bb_2d_tl_y_median_lag_5', u'video_room_bb_2d_tl_y_median_lag_4', u'probability_of_value_study_lag_10', u'video_room_bb_3d_flt_y_min_lag_10', u'video_room_bb_3d_brb_y_length_lag_10', u'rssi_Upstairs_AP_median_lag_9', u'rssi_Upstairs_AP_median_lag_8', u'video_room_centre_3d_y_std_lag_9', u'video_room_centre_3d_y_std_lag_8', u'rssi_Upstairs_AP_median_lag_5', u'rssi_Upstairs_AP_median_lag_4', u'video_room_centre_3d_y_std_lag_5', u'video_room_centre_3d_y_std_lag_4', u'rssi_Upstairs_AP_median_lag_1', u'video_room_centre_3d_y_std_lag_2', u'video_room_centre_3d_y_std_lag_1', u'rssi_Upstairs_AP_median_lag_2', u'video_room_centre_3d_x_std_lag_10', u'video_room_bb_3d_flt_x_mean', u'video_room_bb_2d_tl_x_std_lag_10', u'video_room_centre_3d_z_max_lag_9', u'video_room_centre_3d_z_max_lag_8', u'video_room_centre_3d_z_max_lag_5', u'video_room_centre_3d_z_max_lag_4', u'video_room_centre_3d_z_max_lag_7', u'video_room_centre_3d_z_max_lag_6', u'video_room_centre_3d_z_max_lag_1', u'video_room_centre_3d_z_max_lag_3', u'video_room_centre_3d_z_max_lag_2', u'video_room_bb_3d_brb_x_length_lag_10', u'acceleration_y_median_lag_6', u'acceleration_y_median_lag_7', u'acceleration_y_median_lag_4', u'acceleration_y_median_lag_5', u'acceleration_y_median_lag_2', u'acceleration_y_median_lag_3', u'acceleration_y_median_lag_1', u'acceleration_y_median_lag_8', u'acceleration_y_median_lag_9', u'target', u'video_room_centre_3d_z_min_lag_7', u'video_room_centre_3d_z_min_lag_6', u'video_room_centre_3d_z_min_lag_5', u'video_room_centre_3d_z_min_lag_4', u'video_room_centre_3d_z_min_lag_3', u'video_room_centre_3d_z_min_lag_2', u'video_room_centre_3d_z_min_lag_1', u'video_room_centre_3d_z_min_lag_9', u'video_room_centre_3d_z_min_lag_8', u'rssi_Study_AP_std_lag_10', u'rssi_Upstairs_AP_max_lag_10', u'acceleration_x_min', u'rssi_Lounge_AP_median_lag_9', u'video_room_bb_2d_tl_x_std', u'video_room_bb_3d_brb_y_std', u'video_room_bb_3d_brb_y_max_lag_3', u'probability_of_value_study', u'video_room_bb_3d_brb_x_median_lag_2', u'video_room_bb_3d_brb_x_median_lag_3', u'video_room_bb_3d_flt_z_min_lag_1', u'video_room_bb_3d_brb_x_median_lag_1', u'video_room_bb_3d_brb_x_median_lag_6', u'video_room_bb_3d_brb_x_median_lag_7', u'video_room_bb_3d_brb_x_median_lag_4', u'video_room_bb_3d_brb_x_median_lag_5', u'video_room_bb_3d_brb_x_median_lag_8', u'video_room_bb_3d_brb_x_median_lag_9', u'video_room_bb_3d_flt_y_std_lag_9', u'video_room_bb_3d_flt_y_std_lag_8', u'video_room_bb_3d_flt_y_std_lag_3', u'video_room_bb_3d_flt_y_std_lag_2', u'video_room_bb_3d_flt_y_std_lag_1', u'video_room_bb_3d_flt_y_std_lag_7', u'video_room_bb_3d_flt_y_std_lag_6', u'video_room_bb_3d_flt_y_std_lag_5', u'video_room_bb_3d_flt_y_std_lag_4', u'video_room_centre_3d_y_mean_lag_6', u'video_room_centre_3d_y_mean_lag_7', u'video_room_centre_3d_y_mean_lag_4', u'video_room_centre_3d_y_mean_lag_5', u'video_room_centre_3d_y_mean_lag_2', u'video_room_centre_3d_y_mean_lag_3', u'video_room_centre_3d_y_mean_lag_1', u'rssi_Upstairs_AP_std_lag_3', u'rssi_Upstairs_AP_std_lag_2', u'rssi_Upstairs_AP_std_lag_1', u'rssi_Upstairs_AP_std_lag_7', u'rssi_Upstairs_AP_std_lag_6', u'video_room_centre_3d_y_mean_lag_8', u'video_room_centre_3d_y_mean_lag_9', u'acceleration_z_min_lag_1', u'acceleration_z_min_lag_6', u'video_room_centre_2d_x_length_lagdiff', u'video_room_centre_3d_z_mean_lagdiff', u'acceleration_z_min_lag_7', u'video_room_bb_2d_tl_y_std_lag_9', u'video_room_bb_2d_tl_y_std_lag_8', u'video_room_bb_2d_tl_y_std_lag_5', u'video_room_bb_2d_tl_y_std_lag_4', u'video_room_bb_2d_tl_y_std_lag_7', u'video_room_bb_2d_tl_y_std_lag_6', u'video_room_bb_2d_tl_y_std_lag_1', u'video_room_bb_2d_tl_y_std_lag_3', u'video_room_bb_2d_tl_y_std_lag_2', u'rssi_Kitchen_AP_median', u'rssi_Upstairs_AP_median_lag_6', u'video_room_centre_2d_x_length_lag_9', u'probability_of_value_hall_bas_lag_3', u'video_room_bb_2d_tl_y_min_lag_9', u'video_room_bb_2d_tl_x_min', u'video_room_centre_2d_x_length_lag_4', u'video_room_centre_3d_z_mean_lag_5', u'video_room_centre_3d_z_mean_lag_4', u'video_room_centre_3d_z_mean_lag_3', u'probability_of_value_hall_bas_lag_8', u'video_room_centre_3d_z_mean_lag_1', u'video_room_centre_2d_x_length_lag_2', u'rssi_Lounge_AP_std_lag_4', u'rssi_Lounge_AP_std_lag_5', u'rssi_Lounge_AP_std_lag_6', u'rssi_Lounge_AP_std_lag_7', u'rssi_Lounge_AP_std_lag_1', u'rssi_Lounge_AP_std_lag_2', u'rssi_Lounge_AP_std_lag_3', u'rssi_Lounge_AP_std_lag_8', u'rssi_Lounge_AP_std_lag_9', u'probability_of_value_living_lag_10', u'video_room_centre_2d_x_std', u'video_room_centre_2d_x_std_lag_5', u'video_room_centre_2d_x_std_lag_4', u'video_room_centre_2d_x_std_lag_7', u'video_room_centre_2d_x_std_lag_6', u'video_room_centre_2d_x_std_lag_1', u'video_room_centre_2d_x_std_lag_3', u'video_room_centre_2d_x_std_lag_2', u'acceleration_y_mean_lag_1', u'acceleration_y_mean_lag_3', u'acceleration_y_mean_lag_2', u'video_room_centre_2d_x_std_lag_9', u'video_room_centre_2d_x_std_lag_8', u'acceleration_y_mean_lag_7', u'acceleration_y_mean_lag_6', u'video_room_centre_2d_y_max_lag_8', u'video_room_centre_2d_x_mean', u'probability_of_value_bed2_lag_7', u'video_room_bb_3d_brb_z_min_lag_7', u'video_room_bb_3d_brb_z_min_lag_6', u'video_room_bb_3d_brb_z_min_lag_5', u'video_room_bb_3d_brb_z_min_lag_4', u'video_room_bb_3d_brb_z_min_lag_3', u'video_room_bb_3d_brb_z_min_lag_2', u'video_room_bb_3d_brb_z_min_lag_1', u'video_room_centre_2d_y_max_lag_1', u'video_room_bb_3d_brb_z_min_lag_9', u'video_room_bb_3d_brb_z_min_lag_8', u'rssi_Lounge_AP_max_lag_1', u'rssi_Lounge_AP_max_lag_3', u'rssi_Lounge_AP_max_lag_2', u'rssi_Lounge_AP_max_lag_5', u'rssi_Lounge_AP_max_lag_4', u'rssi_Lounge_AP_max_lag_7', u'rssi_Lounge_AP_max_lag_6', u'rssi_Lounge_AP_max_lag_9', u'rssi_Lounge_AP_max_lag_8', u'video_room_bb_2d_tl_y_mean_lag_10', u'rssi_Study_AP_median_bool', u'probability_of_value_stairs_lag_10', u'video_room_centre_2d_x_min_lag_10', u'video_room_centre_2d_x_median_lag_10', u'video_room_bb_2d_br_x_std_lag_10', u'video_room_bb_3d_flt_y_mean_lag_2', u'video_room_bb_3d_flt_y_mean_lag_3', u'video_room_bb_3d_flt_y_mean_lag_1', u'video_room_bb_3d_flt_y_mean_lag_6', u'video_room_bb_3d_flt_y_mean_lag_7', u'video_room_bb_3d_flt_y_mean_lag_4', u'video_room_bb_3d_flt_y_mean_lag_5', u'video_room_bb_3d_flt_y_mean_lag_8', u'video_room_bb_3d_flt_y_mean_lag_9', u'video_room_bb_2d_tl_x_min_lag_10', u'video_room_centre_3d_z_std_lag_8', u'video_room_centre_3d_z_std_lag_9', u'video_room_centre_2d_x_min_lag_8', u'video_room_centre_2d_x_min_lag_9', u'video_room_centre_2d_x_min_lag_6', u'video_room_centre_2d_x_min_lag_7', u'video_room_centre_3d_z_std_lag_2', u'video_room_centre_3d_z_std_lag_3', u'video_room_centre_3d_z_std_lag_4', u'video_room_centre_3d_z_std_lag_5', u'video_room_centre_3d_z_std_lag_6', u'video_room_centre_3d_z_std_lag_7', u'video_room_bb_2d_br_y_std_lag_9', u'video_room_bb_2d_br_y_std_lag_8', u'video_room_bb_2d_br_y_std_lag_1', u'video_room_bb_2d_br_y_std_lag_3', u'video_room_bb_2d_br_y_std_lag_2', u'video_room_bb_2d_br_y_std_lag_5', u'video_room_bb_2d_br_y_std_lag_4', u'video_room_bb_2d_br_y_std_lag_7', u'video_room_bb_2d_br_y_std_lag_6', u'video_room_bb_2d_tl_y_max_lag_10', u'rssi_Kitchen_AP_std_lag_10', u'acceleration_y_min_lag_5', u'acceleration_y_min_lag_4', u'acceleration_y_min_lag_7', u'acceleration_y_min_lag_6', u'acceleration_x_min_lag_8', u'acceleration_x_min_lag_9', u'acceleration_y_min_lag_3', u'acceleration_y_min_lag_2', u'acceleration_x_min_lag_5', u'acceleration_x_min_lag_6', u'acceleration_x_min_lag_7', u'acceleration_y_min_lag_9', u'acceleration_x_min_lag_1', u'acceleration_x_min_lag_2', u'acceleration_x_min_lag_3', u'video_room_bb_2d_tl_x_min_lag_7', u'video_room_bb_2d_tl_x_min_lag_6', u'video_room_bb_2d_tl_x_min_lag_5', u'video_room_bb_2d_tl_x_min_lag_4', u'video_room_bb_2d_tl_x_min_lag_3', u'video_room_bb_2d_tl_x_min_lag_2', u'video_room_bb_2d_tl_x_min_lag_1', u'video_room_bb_2d_tl_x_min_lag_9', u'video_room_bb_2d_tl_x_min_lag_8', u'video_room_bb_2d_tl_y_min', u'video_room_bb_3d_brb_y_std_lag_10', u'room_angle_turn_x_lag_9', u'room_angle_turn_x_lag_8', u'room_angle_turn_x_lag_3', u'room_angle_turn_x_lag_2', u'room_angle_turn_x_lag_1', u'room_angle_turn_x_lag_7', u'room_angle_turn_x_lag_6', u'room_angle_turn_x_lag_5', u'video_room_centre_3d_z_mean_lag_10', u'acceleration_x_median_lag_10', u'rssi_Study_AP_min_lag_10', u'video_room_bb_3d_brb_x_min_lag_10', u'rssi_Upstairs_AP_min_lag_10', u'video_room_bb_2d_tl_x_mean_lag_10', u'rssi_Kitchen_AP_min_lag_8', u'video_room_bb_3d_flt_x_max', u'rssi_Kitchen_AP_min_lag_1', u'rssi_Kitchen_AP_min_lag_2', u'rssi_Kitchen_AP_min_lag_3', u'rssi_Kitchen_AP_min_lag_4', u'rssi_Kitchen_AP_min_lag_5', u'rssi_Kitchen_AP_min_lag_6', u'rssi_Kitchen_AP_min_lag_7', u'rssi_Lounge_AP_max_lag_10', u'video_room_centre_2d_y_std_lag_2', u'room_angle_turn_x_lag_4', u'video_room_bb_3d_flt_y_max_lag_10',  u'video_room_bb_3d_flt_x_median', u'video_room_bb_3d_flt_z_std_lag_10', u'video_room_centre_3d_z_min', u'rssi_Study_AP_mean', u'rssi_Study_AP_median_lag_10', u'video_room_centre_3d_z_std', u'room_angle_turn_x_lag_10', u'video_room_bb_3d_brb_z_std', u'video_room_bb_2d_br_y_std_lag_10', u'video_room_bb_3d_brb_z_median', u'video_room_centre_3d_x_median', u'video_room_bb_2d_br_y_mean_lag_8', u'video_room_bb_2d_br_y_mean_lag_9', u'video_room_bb_2d_br_y_mean_lag_1', u'video_room_bb_2d_br_y_mean_lag_2', u'video_room_bb_2d_br_y_mean_lag_3', u'video_room_bb_2d_br_y_mean_lag_4', u'video_room_bb_2d_br_y_mean_lag_5', u'video_room_bb_2d_br_y_mean_lag_6', u'video_room_bb_2d_br_y_mean_lag_7', u'speed_room_centre_3d_horizontal', u'video_room_centre_3d_z_std_lag_1', u'video_room_centre_2d_x_min_lag_4', u'video_room_centre_2d_x_min_lag_5', u'video_room_centre_2d_x_min_lag_2', u'video_room_centre_2d_x_min_lag_3', u'acceleration_y_median', u'video_room_centre_2d_x_min_lag_1', u'probability_of_value_bath_lag_10', u'video_room_bb_3d_brb_y_length_lag_3', u'video_room_bb_3d_brb_y_length_lag_2', u'video_room_bb_3d_brb_y_length_lag_1', u'video_room_bb_3d_brb_y_length_lag_7', u'video_room_bb_3d_brb_y_length_lag_6', u'video_room_bb_3d_brb_y_length_lag_5', u'video_room_bb_3d_brb_y_length_lag_4', u'video_room_bb_3d_brb_y_length_lag_9', u'video_room_bb_3d_brb_y_length_lag_8', u'video_room_bb_3d_flt_x_mean_lag_10', u'video_room_bb_2d_tl_x_mean', u'video_room_centre_2d_y_min', u'video_room_bb_2d_tl_x_std_lag_8', u'video_room_bb_2d_tl_x_std_lag_9', u'video_room_bb_2d_tl_x_std_lag_1', u'video_room_bb_2d_tl_x_std_lag_2', u'video_room_bb_2d_tl_x_std_lag_3', u'video_room_bb_2d_tl_x_std_lag_4', u'video_room_bb_2d_tl_x_std_lag_5', u'video_room_bb_2d_tl_x_std_lag_6', u'video_room_bb_2d_tl_x_std_lag_7', u'acceleration_x_median_lagdiff_lagdiff', u'video_room_bb_2d_tl_y_min_lag_10', u'video_room_centre_2d_y_std_lag_10', u'probability_of_value_bath_lag_4', u'probability_of_value_bath_lag_5', u'probability_of_value_bath_lag_6', u'probability_of_value_bath_lag_7', u'probability_of_value_bath_lag_1', u'probability_of_value_bath_lag_2', u'probability_of_value_bath_lag_3', u'video_room_bb_2d_br_y_median', u'probability_of_value_bath_lag_8', u'probability_of_value_bath_lag_9', u'acceleration_z_std', u'rssi_Lounge_AP_median_lag_10', u'video_room_bb_3d_brb_y_max_lag_10', u'video_room_bb_3d_flt_y_std', u'video_room_bb_2d_br_x_median_lag_10', u'video_room_bb_3d_brb_x_mean', u'video_room_bb_2d_br_y_std', u'acceleration_z_mean_lag_4', u'acceleration_z_mean_lag_5', u'acceleration_z_mean_lag_6', u'acceleration_z_mean_lag_7', u'acceleration_z_mean_lag_1', u'acceleration_z_mean_lag_2', u'acceleration_z_mean_lag_3', u'acceleration_z_mean_lag_8', u'acceleration_z_mean_lag_9', u'video_room_bb_3d_flt_x_median_lag_10', u'video_room_bb_3d_brb_x_length_lag_4', u'video_room_bb_3d_brb_z_std_lag_9', u'video_room_bb_3d_brb_x_length_lag_6', u'video_room_bb_3d_brb_x_length_lag_7', u'video_room_bb_3d_brb_x_length_lag_1', u'video_room_bb_3d_brb_x_length_lag_2', u'video_room_bb_3d_brb_x_length_lag_3', u'video_room_bb_3d_brb_z_std_lag_1', u'video_room_bb_3d_brb_z_std_lag_2', u'video_room_bb_3d_brb_z_std_lag_3', u'video_room_bb_3d_brb_x_length_lag_8', u'video_room_bb_3d_brb_x_length_lag_9', u'video_room_bb_3d_brb_z_std_lag_6', u'video_room_bb_3d_brb_z_std_lag_7', u'acceleration_z_max_lag_10', u'video_room_centre_2d_x_length', u'video_room_centre_3d_z_mean', u'acceleration_x_mean', u'rssi_Kitchen_AP_max_lag_10', u'acceleration_z_mean_lag_10', u'video_room_bb_3d_flt_y_mean', u'video_room_bb_3d_brb_y_min_lag_1', u'video_room_bb_3d_brb_y_min_lag_2', u'video_room_bb_3d_brb_y_min_lag_3', u'video_room_bb_3d_brb_y_min_lag_4', u'video_room_bb_3d_brb_y_min_lag_5', u'video_room_bb_3d_brb_y_min_lag_6', u'video_room_bb_3d_brb_y_min_lag_7', u'video_room_bb_3d_brb_y_min_lag_8', u'video_room_bb_3d_brb_y_min_lag_9', u'video_room_bb_2d_tl_x_median_lag_10', u'acceleration_room_centre_3d_vertical', u'video_room_bb_3d_flt_z_mean', u'video_room_centre_3d_z_min_lag_10', u'video_room_bb_3d_brb_y_mean', u'video_room_centre_3d_z_median', u'rssi_Lounge_AP_min_lag_10', u'video_room_bb_3d_brb_y_median', u'acceleration_y_min_lag_1', u'acceleration_x_min_lag_4', u'video_room_bb_3d_flt_z_min_lag_2', u'acceleration_y_min_lag_8', u'video_room_bb_2d_br_x_max_lag_1', u'video_room_bb_2d_br_x_max_lag_3', u'video_room_bb_2d_br_x_max_lag_2', u'video_room_bb_2d_br_x_max_lag_5', u'video_room_bb_2d_br_x_max_lag_4', u'video_room_bb_2d_br_x_max_lag_7', u'video_room_bb_2d_br_x_max_lag_6', u'video_room_bb_2d_br_x_max_lag_9', u'video_room_bb_2d_br_x_max_lag_8', u'rssi_Lounge_AP_std_lag_10', u'probability_of_value_hall_haut_lag_8', u'video_room_centre_2d_y_median_lag_10', u'rssi_Kitchen_AP_median_lag_5', u'rssi_Kitchen_AP_median_lag_4', u'rssi_Kitchen_AP_median_lag_7', u'rssi_Kitchen_AP_median_lag_6', u'rssi_Kitchen_AP_median_lag_1', u'rssi_Kitchen_AP_median_lag_3', u'rssi_Kitchen_AP_median_lag_2', u'rssi_Kitchen_AP_median_lag_9', u'rssi_Kitchen_AP_median_lag_8', u'rssi_Study_AP_min_lag_7', u'rssi_Study_AP_min_lag_6', u'rssi_Study_AP_min_lag_5', u'rssi_Study_AP_min_lag_4', u'rssi_Study_AP_min_lag_3', u'rssi_Study_AP_min_lag_2', u'rssi_Study_AP_min_lag_1', u'video_room_bb_2d_br_y_min', u'rssi_Study_AP_min_lag_9', u'rssi_Study_AP_min_lag_8', u'acceleration_y_max_lag_9', u'acceleration_y_max_lag_8', u'acceleration_y_max_lag_7', u'acceleration_y_max_lag_6', u'acceleration_y_max_lag_5', u'acceleration_y_max_lag_4', u'acceleration_y_max_lag_3', u'acceleration_y_max_lag_2', u'acceleration_y_max_lag_1', u'video_room_bb_2d_br_y_mean_lag_10', u'video_room_bb_3d_brb_x_max_lag_5', u'acceleration_z_min_lag_10', u'rssi_Kitchen_AP_min_lag_10', u'rssi_Upstairs_AP_mean_lag_6', u'video_room_centre_2d_x_max_lag_10', u'video_room_bb_3d_flt_z_max', u'video_room_bb_3d_flt_x_std_lag_10', u'pir_lag_1', u'pir_lag_2', u'pir_lag_3', u'pir_lag_4', u'pir_lag_5', u'pir_lag_6', u'pir_lag_7', u'pir_lag_8', u'pir_lag_9', u'acceleration_y_std_lag_6', u'acceleration_y_std_lag_7', u'acceleration_y_std_lag_4', u'acceleration_y_std_lag_5', u'acceleration_y_std_lag_2', u'acceleration_y_std_lag_3', u'acceleration_y_std_lag_1', u'acceleration_y_std_lag_8', u'acceleration_y_std_lag_9', u'probability_of_value_stairs_lag_9', u'probability_of_value_stairs_lag_8', u'probability_of_value_stairs_lag_7', u'probability_of_value_stairs_lag_6', u'probability_of_value_stairs_lag_5', u'probability_of_value_stairs_lag_4', u'probability_of_value_stairs_lag_3', u'probability_of_value_stairs_lag_2', u'probability_of_value_stairs_lag_1', u'video_room_bb_3d_flt_x_max_lag_9', u'video_room_bb_3d_flt_x_max_lag_8', u'video_room_bb_3d_flt_x_max_lag_7', u'video_room_bb_3d_flt_x_max_lag_6', u'video_room_bb_3d_flt_x_max_lag_5', u'video_room_bb_3d_flt_x_max_lag_4', u'video_room_bb_3d_flt_x_max_lag_3', u'video_room_bb_3d_flt_x_max_lag_2', u'video_room_bb_3d_flt_x_max_lag_1', u'video_room_centre_2d_x_mean_lag_10', u'video_room_bb_3d_flt_z_min_lag_6', u'acceleration_y_min', u'video_room_bb_3d_brb_x_length_lagdiff', u'probability_of_value_kitchen_lag_10', u'acceleration_x_median_lagdiff', u'video_room_bb_3d_flt_z_std_lag_4', u'video_room_bb_3d_flt_z_std_lag_5', u'video_room_bb_3d_flt_z_std_lag_6', u'video_room_bb_3d_flt_z_std_lag_7', u'video_room_bb_3d_flt_z_std_lag_1', u'video_room_bb_3d_flt_z_std_lag_2', u'video_room_bb_3d_flt_z_std_lag_3', u'video_room_bb_3d_flt_z_std_lag_8', u'video_room_bb_3d_flt_z_std_lag_9', u'video_room', u'video_room_centre_2d_x_mean_lag_9', u'video_room_centre_2d_y_mean_lag_9', u'video_room_centre_2d_y_mean_lag_8', u'video_room_centre_2d_y_mean_lag_7', u'video_room_centre_2d_y_mean_lag_6', u'video_room_centre_2d_y_mean_lag_5', u'video_room_centre_2d_y_mean_lag_4', u'video_room_centre_2d_y_mean_lag_3', u'video_room_centre_3d_x_max', u'video_room_centre_2d_y_mean_lag_1', u'acceleration_y_std', u'video_room_centre_3d_x_min_lag_9', u'video_room_centre_3d_x_min_lag_8', u'video_room_centre_3d_x_min_lag_1', u'video_room_centre_3d_x_min_lag_3', u'video_room_centre_3d_x_min_lag_2', u'video_room_centre_3d_x_min_lag_5', u'video_room_centre_3d_x_min_lag_4', u'video_room_centre_3d_x_min_lag_7', u'video_room_centre_3d_x_min_lag_6', u'video_room_bb_2d_br_x_std', u'video_room_bb_2d_br_x_max', u'acceleration_x_std_lag_10', u'video_room_bb_2d_br_x_max_lag_10', u'video_room_bb_2d_tl_y_mean_lag_4', u'video_room_bb_2d_tl_y_mean_lag_5', u'probability_of_value_bed2_lag_4', u'probability_of_value_bed2_lag_5', u'probability_of_value_bed2_lag_2', u'probability_of_value_bed2_lag_3', u'video_room_bb_2d_tl_y_mean_lag_2', u'probability_of_value_bed2_lag_1', u'video_room_bb_2d_tl_y_mean_lag_8', u'video_room_bb_2d_tl_y_mean_lag_9', u'probability_of_value_bed2_lag_8', u'probability_of_value_bed2_lag_9', u'probability_of_value_bath', u'video_room_bb_2d_br_x_std_lag_4', u'video_room_bb_2d_br_x_std_lag_5', u'video_room_bb_2d_br_x_std_lag_6', u'video_room_bb_2d_br_x_std_lag_7', u'video_room_bb_2d_br_x_std_lag_1', u'video_room_bb_2d_br_x_std_lag_2', u'video_room_bb_2d_br_x_std_lag_3', u'video_room_bb_2d_br_x_std_lag_8', u'video_room_bb_2d_br_x_std_lag_9', u'rssi_Kitchen_AP_mean', u'probability_of_value_kitchen_lag_2', u'probability_of_value_kitchen_lag_3', u'probability_of_value_kitchen_lag_1', u'probability_of_value_kitchen_lag_6', u'probability_of_value_kitchen_lag_7', u'probability_of_value_kitchen_lag_4', u'probability_of_value_kitchen_lag_5', u'probability_of_value_kitchen_lag_8', u'probability_of_value_kitchen_lag_9', u'rssi_Lounge_AP_min', u'video_room_centre_2d_x_length_lag_10', u'video_room_centre_2d_y_length', u'video_room_bb_2d_tl_x_median_lag_1', u'video_room_bb_2d_tl_x_median_lag_2', u'video_room_bb_3d_brb_z_min_lag_10', u'video_room_bb_2d_tl_x_median_lag_4', u'video_room_bb_2d_tl_x_median_lag_5', u'video_room_bb_2d_tl_x_median_lag_6', u'video_room_bb_2d_tl_x_median_lag_7', u'video_room_bb_2d_tl_x_median_lag_8', u'video_room_bb_2d_tl_x_median_lag_9', u'video_room_lag_10', u'video_room_bb_2d_br_x_min_lag_3', u'video_room_bb_2d_br_x_min_lag_2', u'video_room_bb_2d_br_x_min_lag_1', u'video_room_bb_2d_br_x_median_lag_8', u'video_room_bb_2d_br_x_median_lag_9', u'video_room_bb_2d_br_x_min_lag_5', u'video_room_bb_2d_br_x_min_lag_4', u'video_room_bb_2d_br_x_median_lag_4', u'video_room_bb_2d_br_x_median_lag_5', u'video_room_bb_2d_br_x_min_lag_9', u'video_room_bb_2d_br_x_median_lag_7', u'video_room_bb_2d_br_x_median_lag_1', u'video_room_bb_2d_br_x_median_lag_2', u'video_room_bb_2d_br_x_median_lag_3', u'rssi_Upstairs_AP_std_lag_4', u'video_room_bb_2d_br_y_max_lag_1', u'video_room_bb_2d_br_y_max_lag_2', u'video_room_bb_2d_br_y_max_lag_3', u'video_room_bb_2d_br_y_max_lag_4', u'video_room_bb_2d_br_y_max_lag_5', u'video_room_bb_2d_br_y_max_lag_6', u'video_room_bb_2d_br_y_max_lag_7', u'video_room_bb_2d_br_y_max_lag_8', u'video_room_bb_2d_br_y_max_lag_9', u'rssi_Upstairs_AP_median', u'video_room_bb_3d_flt_x_median_lag_6', u'video_room_bb_3d_flt_x_median_lag_7', u'video_room_bb_3d_flt_x_median_lag_4', u'video_room_bb_3d_flt_x_median_lag_5', u'video_room_bb_3d_flt_x_median_lag_2', u'video_room_bb_3d_flt_x_median_lag_3', u'video_room_bb_3d_flt_x_median_lag_1', u'video_room_bb_3d_flt_x_median_lag_8', u'video_room_bb_3d_flt_x_median_lag_9', u'video_room_bb_3d_brb_y_median_lag_9', u'video_room_bb_3d_brb_y_median_lag_8', u'video_room_bb_3d_brb_y_median_lag_1', u'video_room_bb_3d_brb_y_median_lag_3', u'video_room_bb_3d_brb_y_median_lag_2', u'video_room_bb_3d_brb_y_median_lag_5', u'video_room_bb_3d_brb_y_median_lag_4', u'video_room_bb_3d_brb_y_median_lag_7', u'video_room_bb_3d_brb_y_median_lag_6', u'acceleration_z_median_lag_10', u'video_room_centre_3d_y_median_lag_10', u'video_room_bb_3d_brb_z_median_lag_1', u'video_room_bb_3d_brb_z_median_lag_2', u'video_room_bb_3d_brb_z_median_lag_3', u'video_room_bb_3d_brb_z_median_lag_4', u'video_room_bb_3d_brb_z_median_lag_5', u'video_room_bb_3d_brb_z_median_lag_6', u'video_room_bb_3d_brb_z_median_lag_7', u'video_room_bb_3d_brb_z_median_lag_8', u'video_room_bb_3d_brb_z_median_lag_9', u'probability_of_value_hall_haut_lag_1', u'probability_of_value_hall_haut_lag_6', u'probability_of_value_hall_haut_lag_7', u'probability_of_value_hall_haut_lag_4', u'probability_of_value_hall_haut_lag_5', u'video_room_centre_3d_y_min_lag_10', u'video_room_bb_3d_flt_x_min_lag_5', u'rssi_Study_AP_std_lag_9', u'video_room_bb_3d_brb_y_median_lag_10', u'video_room_bb_2d_tl_y_median_lag_10', u'video_room_bb_3d_flt_x_min_lag_9', u'video_room_bb_3d_flt_x_min_lag_8', u'video_room_bb_2d_br_y_median_lag_8', u'acceleration_x_mean_lag_2', u'acceleration_x_mean_lag_3', u'acceleration_x_mean_lag_1', u'acceleration_x_mean_lag_6', u'acceleration_x_mean_lag_7', u'acceleration_x_mean_lag_4', u'acceleration_x_mean_lag_5', u'acceleration_x_mean_lag_8', u'acceleration_x_mean_lag_9', u'video_room_centre_3d_x_std', u'video_room_centre_2d_x_max', u'probability_of_value_hall_haut_lag_10', u'video_room_bb_2d_br_y_median_lag_10', u'video_room_bb_3d_brb_y_max_lag_8', u'video_room_bb_3d_brb_y_max_lag_9', u'acceleration_z_min_lag_2', u'video_room_bb_3d_brb_y_max_lag_2', u'video_room_bb_3d_brb_y_max_lag_1', u'video_room_bb_3d_brb_y_max_lag_6', u'video_room_bb_3d_brb_y_max_lag_7', u'video_room_bb_3d_brb_y_max_lag_4', u'video_room_bb_3d_brb_y_max_lag_5', u'acceleration_z_median', u'video_room_bb_2d_tl_y_median_lag_1', u'acceleration_z_min_lag_3', u'rssi_Upstairs_AP_median_lag_10', u'video_room_centre_3d_x_mean_lagdiff', u'rssi_Lounge_AP_median_lag_4', u'rssi_Lounge_AP_median_lag_5', u'rssi_Lounge_AP_median_lag_6', u'rssi_Lounge_AP_median_lag_7', u'video_room_centre_2d_y_max_lag_9', u'rssi_Lounge_AP_median_lag_1', u'rssi_Lounge_AP_median_lag_2', u'rssi_Lounge_AP_median_lag_3', u'video_room_centre_2d_y_max_lag_5', u'video_room_centre_2d_y_max_lag_4', u'video_room_centre_2d_y_max_lag_7', u'video_room_centre_2d_y_max_lag_6', u'rssi_Lounge_AP_median_lag_8', u'video_room_bb_3d_brb_z_mean', u'video_room_centre_2d_y_max_lag_3', u'video_room_centre_2d_y_max_lag_2', u'video_room_bb_3d_flt_y_max', u'video_room_bb_3d_flt_y_max_lag_8', u'video_room_bb_3d_flt_y_max_lag_9', u'video_room_bb_3d_flt_y_max_lag_6', u'video_room_bb_3d_flt_y_max_lag_7', u'video_room_bb_3d_flt_y_max_lag_4', u'video_room_bb_3d_flt_y_max_lag_5', u'video_room_bb_3d_flt_y_max_lag_2', u'video_room_bb_3d_flt_y_max_lag_3', u'video_room_bb_3d_flt_y_max_lag_1', u'acceleration_x_min_lag_10', u'acceleration_z_median_lag_3', u'acceleration_z_median_lag_2', u'acceleration_z_median_lag_1', u'acceleration_z_median_lag_7', u'acceleration_z_median_lag_6', u'acceleration_z_median_lag_5', u'acceleration_z_median_lag_4', u'acceleration_z_median_lag_9', u'acceleration_z_median_lag_8', u'video_room_bb_3d_brb_y_mean_lag_6', u'video_room_bb_3d_brb_y_mean_lag_7', u'video_room_bb_3d_brb_y_mean_lag_4', u'video_room_bb_3d_brb_y_mean_lag_5', u'video_room_bb_3d_brb_y_mean_lag_2', u'video_room_bb_3d_brb_y_mean_lag_3', u'video_room_bb_3d_brb_y_mean_lag_1', u'video_room_bb_3d_brb_y_max', u'video_room_bb_3d_brb_y_mean_lag_8', u'video_room_bb_3d_brb_y_mean_lag_9', u'acceleration_z_min', u'acceleration_x_median', u'acceleration_z_min_lag_5', u'rssi_Kitchen_AP_min_lag_9', u'acceleration_x_max', u'video_room_centre_3d_y_std_lag_7', u'video_room_centre_3d_y_std_lag_6', u'rssi_Upstairs_AP_median_lag_7', u'video_room_bb_3d_brb_x_min', u'rssi_Upstairs_AP_max', u'video_room_centre_3d_y_std_lag_3', u'rssi_Upstairs_AP_median_lag_3', u'video_room_centre_3d_y_max', u'acceleration_z_median_lagdiff', u'video_room_centre_3d_x_mean_lag_9', u'video_room_centre_3d_x_mean_lag_8', u'video_room_centre_3d_x_mean_lag_5', u'video_room_centre_3d_x_mean_lag_4', u'video_room_centre_3d_x_mean_lag_7', u'video_room_centre_3d_x_mean_lag_6', u'video_room_centre_3d_x_mean_lag_1', u'video_room_centre_3d_x_mean_lag_3', u'video_room_centre_3d_x_mean_lag_2', u'rssi_Kitchen_AP_max', u'video_room_bb_2d_tl_y_median', u'rssi_Study_AP_mean_lag_9', u'rssi_Study_AP_mean_lag_8', u'rssi_Study_AP_mean_lag_7', u'rssi_Study_AP_mean_lag_6', u'rssi_Study_AP_mean_lag_5', u'rssi_Study_AP_mean_lag_4', u'rssi_Study_AP_mean_lag_3', u'rssi_Study_AP_mean_lag_2', u'rssi_Study_AP_mean_lag_1', u'rssi_Lounge_AP_median_bool', u'video_room_bb_3d_flt_z_mean_lag_9', u'video_room_bb_3d_flt_z_mean_lag_8', u'video_room_bb_3d_flt_z_mean_lag_3', u'video_room_bb_3d_flt_z_mean_lag_2', u'video_room_bb_3d_flt_z_mean_lag_1', u'video_room_bb_3d_flt_z_mean_lag_7', u'video_room_bb_3d_flt_z_mean_lag_6', u'video_room_bb_3d_flt_z_mean_lag_5', u'video_room_bb_3d_flt_z_mean_lag_4', u'video_room_bb_3d_flt_y_min_lag_4', u'video_room_bb_3d_flt_y_min_lag_5', u'video_room_bb_3d_flt_y_min_lag_6', u'rssi_Study_AP_std_lag_8', u'video_room_bb_3d_flt_x_min_lag_4', u'video_room_bb_3d_flt_x_min_lag_7', u'video_room_bb_3d_flt_x_min_lag_6', u'video_room_bb_3d_flt_x_min_lag_1', u'video_room_bb_3d_flt_x_min_lag_3', u'video_room_bb_3d_flt_x_min_lag_2', u'rssi_Study_AP_std_lag_1', u'rssi_Study_AP_std_lag_2', u'rssi_Study_AP_std_lag_3', u'rssi_Study_AP_std_lag_4', u'rssi_Study_AP_std_lag_5', u'rssi_Study_AP_std_lag_6', u'rssi_Study_AP_std_lag_7', u'probability_of_value_bed1_lag_10', u'video_room_bb_3d_flt_y_min_lag_3', u'video_room_bb_2d_tl_x_max', u'video_room_centre_2d_y_std_lag_8', u'video_room_bb_3d_brb_x_min_lag_8', u'rssi_Study_AP_std', u'acceleration_z_median_lagdiff_lagdiff', u'video_room_bb_3d_brb_z_median_lag_10', u'video_room_bb_3d_flt_y_min_lag_8', u'video_room_bb_3d_flt_y_min_lag_9', u'probability_of_value_living_lag_8', u'probability_of_value_living_lag_9', u'probability_of_value_living_lag_6', u'probability_of_value_living_lag_7', u'probability_of_value_living_lag_4', u'probability_of_value_living_lag_5', u'probability_of_value_living_lag_2', u'probability_of_value_living_lag_3', u'video_room_bb_3d_flt_y_min_lag_2', u'probability_of_value_living_lag_1', u'video_room_centre_2d_y_std_lag_3', u'video_room_bb_3d_brb_x_min_lag_5', u'video_room_centre_2d_y_std_lag_5', u'video_room_bb_3d_brb_x_min_lag_7', u'rssi_Kitchen_AP_std', u'video_room_centre_2d_y_std_lag_7', u'video_room_centre_3d_z_std_lag_10', u'video_room_bb_2d_br_y_min_lag_8', u'video_room_bb_2d_br_y_min_lag_9', u'rssi_Kitchen_AP_median_lag_10', u'video_room_bb_2d_br_y_min_lag_2', u'video_room_bb_2d_br_y_min_lag_3', u'video_room_bb_2d_br_y_min_lag_1', u'video_room_bb_2d_br_y_min_lag_6', u'video_room_bb_2d_br_y_min_lag_7', u'video_room_bb_2d_br_y_min_lag_4', u'video_room_bb_2d_br_y_min_lag_5', u'video_room_bb_3d_brb_x_min_lag_9', u'video_room_centre_3d_y_max_lag_10', u'video_room_bb_3d_brb_x_std_lag_8', u'video_room_bb_3d_brb_x_std_lag_9', u'video_room_bb_3d_brb_x_std_lag_2', u'probability_of_value_hall_bas_lag_9', u'video_room_bb_3d_brb_x_std_lag_1', u'video_room_bb_3d_brb_x_std_lag_6', u'video_room_bb_3d_brb_x_std_lag_7', u'video_room_bb_3d_brb_x_std_lag_4', u'video_room_bb_3d_brb_x_std_lag_5', u'video_room_centre_3d_x_mean_lag_10', u'video_room_bb_2d_tl_y_std', u'video_room_bb_3d_brb_z_min', u'rssi_Upstairs_AP_std', u'rssi_Kitchen_AP_mean_lag_8', u'rssi_Kitchen_AP_mean_lag_9', u'rssi_Kitchen_AP_mean_lag_6', u'rssi_Kitchen_AP_mean_lag_7', u'rssi_Kitchen_AP_mean_lag_4', u'rssi_Kitchen_AP_mean_lag_5', u'rssi_Kitchen_AP_mean_lag_2', u'rssi_Kitchen_AP_mean_lag_3', u'rssi_Kitchen_AP_mean_lag_1', u'video_room_centre_2d_x_length_lag_5', u'video_room_centre_3d_x_mean', u'video_room_centre_3d_z_mean_lagdiff_lagdiff', u'video_room_centre_2d_x_length_lag_7', u'acceleration_room_centre_3d_horizontal', u'rssi_Upstairs_AP_std_lag_10', u'video_room_centre_2d_y_mean_lag_2', u'rssi_Lounge_AP_mean_lag_10', u'video_room_centre_2d_y_mean_lag_10', u'video_room_centre_2d_x_length_lag_1', u'video_room_bb_3d_brb_x_std_lag_3', u'video_room_centre_3d_x_max_lag_10', u'video_room_lag_5', u'video_room_lag_4', u'video_room_lag_7', u'video_room_lag_6', u'video_room_lag_1', u'video_room_lag_3', u'video_room_lag_2', u'video_room_lag_9', u'video_room_lag_8', u'acceleration_y_median_lagdiff', u'acceleration_y_median_lag_10', u'rssi_Lounge_AP_median', u'video_room_centre_2d_y_length_lagdiff', u'video_room_centre_3d_y_mean', u'rssi_Study_AP_max_lag_9', u'rssi_Study_AP_max_lag_8', u'rssi_Study_AP_max_lag_5', u'rssi_Study_AP_max_lag_4', u'rssi_Study_AP_max_lag_7', u'rssi_Study_AP_max_lag_6', u'rssi_Study_AP_max_lag_1', u'rssi_Study_AP_max_lag_3', u'rssi_Study_AP_max_lag_2', u'video_room_bb_2d_br_x_min_lag_7', u'video_room_bb_3d_flt_y_median', u'video_room_bb_2d_br_x_min_lag_6', u'acceleration_x_median_lag_9', u'acceleration_x_median_lag_8', u'acceleration_x_median_lag_5', u'acceleration_x_median_lag_4', u'acceleration_x_median_lag_7', u'acceleration_x_median_lag_6', u'acceleration_x_median_lag_1', u'acceleration_x_median_lag_3', u'acceleration_x_median_lag_2', u'video_room_centre_2d_x_median_lag_9', u'video_room_bb_2d_br_x_mean_lag_10', u'video_room_centre_2d_x_median_lag_7', u'video_room_centre_2d_x_median_lag_6', u'video_room_centre_2d_x_median_lag_5', u'video_room_centre_2d_x_median_lag_4', u'video_room_centre_2d_x_median_lag_3', u'video_room_centre_2d_x_median_lag_2', u'video_room_centre_2d_x_median_lag_1', u'speed_room_centre_3d_vertical', u'video_room_centre_2d_y_min_lag_10', u'video_room_bb_2d_tl_y_std_lag_10', u'room_angle_turn_x_lagdiff', u'video_room_bb_3d_brb_x_median', u'acceleration_z_min_lag_8', u'acceleration_z_min_lag_9', u'acceleration_x_max_lag_8', u'acceleration_x_max_lag_9', u'acceleration_x_max_lag_6', u'acceleration_x_max_lag_7', u'acceleration_x_max_lag_4', u'acceleration_x_max_lag_5', u'acceleration_x_max_lag_2', u'acceleration_x_max_lag_3', u'acceleration_z_min_lag_4', u'acceleration_x_max_lag_1', u'probability_of_value_toilet', u'video_room_bb_3d_brb_y_length', u'acceleration_x_max_lag_10', u'probability_of_value_bed2_lag_6', u'video_room_bb_3d_brb_z_max_lag_10', u'video_room_bb_3d_brb_z_mean_lag_9', u'video_room_bb_3d_brb_z_mean_lag_8', u'video_room_bb_3d_brb_z_mean_lag_7', u'video_room_bb_3d_brb_z_mean_lag_6', u'video_room_bb_3d_brb_z_mean_lag_5', u'video_room_bb_3d_brb_z_mean_lag_4', u'video_room_bb_3d_brb_z_mean_lag_3', u'video_room_bb_3d_brb_z_mean_lag_2', u'video_room_bb_3d_brb_z_mean_lag_1', u'video_room_bb_2d_tl_y_mean_lag_7', u'rssi_Upstairs_AP_median_bool', u'video_room_bb_2d_tl_y_mean_lag_1', u'probability_of_value_bed2', u'probability_of_value_bed1', u'video_room_bb_2d_tl_y_mean_lag_3',  u'rssi_Study_AP_median_lag_1', u'rssi_Study_AP_median_lag_2', u'rssi_Study_AP_median_lag_3', u'rssi_Study_AP_median_lag_4', u'rssi_Study_AP_median_lag_5', u'rssi_Study_AP_median_lag_6', u'rssi_Study_AP_median_lag_7', u'rssi_Study_AP_median_lag_8', u'rssi_Study_AP_median_lag_9', u'probability_of_value_bed1_lag_9', u'probability_of_value_bed1_lag_8', u'probability_of_value_bed1_lag_5', u'probability_of_value_bed1_lag_4', u'probability_of_value_bed1_lag_7', u'probability_of_value_bed1_lag_6', u'probability_of_value_bed1_lag_1', u'probability_of_value_bed1_lag_3', u'probability_of_value_bed1_lag_2', u'video_room_bb_2d_br_y_mean', u'video_room_centre_3d_z_max', u'video_room_bb_2d_br_y_min_lag_10', u'video_room_bb_2d_tl_y_mean_lag_6', u'video_room_centre_3d_y_min_lag_1', u'video_room_centre_3d_y_min_lag_2', u'video_room_centre_3d_y_min_lag_3', u'video_room_centre_3d_y_min_lag_4', u'video_room_centre_3d_y_min_lag_5', u'video_room_centre_3d_y_min_lag_6', u'video_room_centre_3d_y_min_lag_7', u'video_room_centre_3d_y_min_lag_8', u'video_room_centre_3d_y_min_lag_9', u'video_room_bb_2d_tl_x_median', u'probability_of_value_toilet_lag_10', u'video_room_bb_3d_flt_y_median_lag_10', u'video_room_centre_3d_x_max_lag_9', u'video_room_centre_3d_x_max_lag_8', u'video_room_centre_3d_x_max_lag_3', u'video_room_centre_3d_x_max_lag_2', u'video_room_centre_3d_x_max_lag_1', u'video_room_centre_3d_x_max_lag_7', u'video_room_centre_3d_x_max_lag_6', u'video_room_centre_3d_x_max_lag_5', u'video_room_centre_3d_x_max_lag_4', u'video_room_bb_3d_brb_x_max_lag_9', u'video_room_bb_3d_brb_x_max_lag_8', u'video_room_bb_3d_brb_x_max_lag_3', u'video_room_bb_3d_brb_x_max_lag_2', u'video_room_bb_3d_brb_x_max_lag_1', u'video_room_bb_3d_brb_x_max_lag_7', u'video_room_bb_3d_brb_x_max_lag_6', u'video_room_bb_3d_flt_z_median', u'video_room_bb_3d_brb_x_max_lag_4', u'probability_of_value_hall_bas', u'probability_of_value_living', u'video_room_bb_2d_tl_y_min_lag_8', u'rssi_Lounge_AP_mean', u'video_room_centre_2d_y_max', u'video_room_centre_2d_x_mean_lag_8', u'video_room_bb_2d_tl_y_min_lag_6', u'video_room_centre_2d_x_mean_lag_1', u'video_room_centre_2d_x_mean_lag_2', u'video_room_centre_2d_x_mean_lag_3', u'video_room_centre_2d_x_mean_lag_4', u'video_room_centre_2d_x_mean_lag_5', u'video_room_centre_2d_x_mean_lag_6', u'video_room_centre_2d_x_mean_lag_7', u'rssi_Kitchen_AP_median_bool', u'video_room_bb_2d_tl_y_min_lag_7', u'video_room_bb_3d_brb_y_min_lag_10', u'video_room_bb_3d_brb_y_std_lag_9', u'video_room_bb_3d_brb_y_std_lag_8', u'acceleration_y_median_lagdiff_lagdiff', u'video_room_bb_3d_brb_y_std_lag_6', u'video_room_bb_3d_brb_y_std_lag_5', u'video_room_bb_3d_brb_y_std_lag_4', u'video_room_bb_3d_brb_y_std_lag_3', u'video_room_bb_3d_brb_y_std_lag_2', u'video_room_bb_3d_brb_y_std_lag_1', u'rssi_Study_AP_min', u'video_room_bb_2d_tl_y_min_lag_5', u'video_room_bb_3d_flt_z_min_lag_3', u'video_room_bb_3d_flt_z_min_lag_7', u'video_room_bb_3d_flt_z_min', u'rssi_Lounge_AP_mean_lag_9', u'rssi_Lounge_AP_mean_lag_8', u'video_room_bb_3d_brb_x_median_lag_10', u'video_room_bb_3d_flt_z_min_lag_5', u'video_room_bb_2d_tl_y_min_lag_3', u'rssi_Lounge_AP_mean_lag_3', u'rssi_Lounge_AP_mean_lag_2', u'rssi_Lounge_AP_mean_lag_1', u'video_room_bb_3d_flt_z_min_lag_4', u'rssi_Lounge_AP_mean_lag_7', u'rssi_Lounge_AP_mean_lag_6', u'rssi_Lounge_AP_mean_lag_5', u'rssi_Lounge_AP_mean_lag_4', u'video_room_bb_2d_tl_x_median_lag_3', u'probability_of_value_hall_haut', u'video_room_bb_3d_flt_z_std', u'video_room_bb_3d_flt_z_min_lag_9', u'video_room_bb_3d_flt_z_min_lag_8', u'video_room_bb_3d_brb_x_mean_lag_5', u'video_room_bb_3d_flt_z_mean_lag_10', u'acceleration_x_mean_lag_10', u'video_room_bb_3d_brb_x_max_lag_10', u'video_room_bb_2d_br_x_median_lag_6', u'video_room_bb_2d_br_x_min_lag_8', u'rssi_Upstairs_AP_std_lag_9', u'rssi_Upstairs_AP_std_lag_8', u'video_room_centre_3d_z_max_lag_10', u'video_room_bb_3d_brb_x_mean_lag_9', u'video_room_bb_3d_brb_x_mean_lag_8', u'probability_of_value_bed2_lag_10', u'video_room_bb_3d_brb_x_mean_lag_4', u'video_room_bb_3d_brb_x_mean_lag_7', u'video_room_bb_3d_brb_x_mean_lag_6', u'video_room_bb_3d_brb_x_mean_lag_1', u'video_room_bb_3d_brb_x_mean_lag_3', u'video_room_bb_3d_brb_x_mean_lag_2', u'video_room_bb_3d_brb_x_std', u'room_angle_turn_x_lagdiff_abs', u'video_room_centre_2d_x_std_lag_10', u'video_room_bb_3d_brb_y_mean_lag_10', u'video_room_bb_3d_brb_y_length_lagdiff', u'video_room_bb_2d_br_x_min_lag_10', u'video_room_centre_3d_y_std', u'rssi_Upstairs_AP_max_lag_8', u'rssi_Upstairs_AP_max_lag_9', u'rssi_Upstairs_AP_max_lag_2', u'rssi_Upstairs_AP_max_lag_3', u'rssi_Upstairs_AP_max_lag_1', u'rssi_Upstairs_AP_max_lag_6', u'rssi_Upstairs_AP_max_lag_7', u'rssi_Upstairs_AP_max_lag_4', u'rssi_Upstairs_AP_max_lag_5', u'video_room_bb_3d_flt_x_std_lag_6', u'video_room_bb_3d_flt_x_std_lag_7', u'video_room_bb_3d_flt_x_std_lag_4', u'video_room_bb_3d_flt_x_std_lag_5', u'video_room_bb_3d_flt_x_std_lag_2', u'video_room_bb_3d_flt_x_std_lag_3', u'video_room_bb_3d_flt_x_std_lag_1', u'video_room_bb_3d_flt_x_std_lag_8', u'video_room_bb_3d_flt_x_std_lag_9', u'video_room_centre_3d_y_max_lag_8', u'video_room_centre_3d_y_max_lag_9', u'video_room_centre_3d_y_max_lag_2', u'video_room_centre_3d_y_max_lag_3', u'video_room_centre_3d_y_max_lag_1', u'video_room_centre_3d_y_max_lag_6', u'video_room_centre_3d_y_max_lag_7', u'video_room_centre_3d_y_max_lag_4', u'video_room_centre_3d_y_max_lag_5', u'video_room_bb_2d_br_x_median', u'video_room_bb_3d_flt_x_min', u'video_room_centre_2d_y_median', u'video_room_bb_2d_tl_y_max', u'acceleration_z_std_lag_10', u'rssi_Kitchen_AP_mean_lag_10', u'video_room_centre_2d_x_max_lag_8', u'video_room_centre_2d_x_max_lag_9', u'video_room_centre_2d_x_max_lag_4', u'video_room_centre_2d_x_max_lag_5', u'video_room_centre_2d_x_max_lag_6', u'video_room_centre_2d_x_max_lag_7', u'video_room_centre_2d_x_max_lag_1', u'video_room_centre_2d_x_max_lag_2', u'video_room_centre_2d_x_max_lag_3', u'video_room_bb_2d_br_y_max', u'video_room_bb_2d_tl_x_max_lag_10', u'video_room_centre_3d_y_median_lag_9', u'video_room_centre_3d_y_median_lag_8', u'acceleration_z_std_lag_3', u'acceleration_z_std_lag_2', u'acceleration_z_std_lag_5', u'acceleration_z_std_lag_4', u'acceleration_z_std_lag_7', u'acceleration_z_std_lag_6', u'acceleration_z_std_lag_9', u'acceleration_z_std_lag_8', u'video_room_centre_3d_y_median_lag_3', u'video_room_centre_3d_y_median_lag_2', u'video_room_centre_3d_y_median_lag_5', u'video_room_centre_3d_y_median_lag_4', u'video_room_centre_3d_y_median_lag_7', u'video_room_centre_3d_y_median_lag_6', u'rssi_Lounge_AP_min_lag_3', u'rssi_Lounge_AP_min_lag_2', u'rssi_Lounge_AP_min_lag_1', u'rssi_Lounge_AP_min_lag_7', u'rssi_Lounge_AP_min_lag_6', u'rssi_Lounge_AP_min_lag_5', u'rssi_Lounge_AP_min_lag_4', u'rssi_Lounge_AP_min_lag_9', u'rssi_Lounge_AP_min_lag_8', u'video_room_centre_3d_z_median_lag_1', u'video_room_centre_3d_z_median_lag_2', u'video_room_centre_3d_z_median_lag_3', u'video_room_centre_3d_z_median_lag_4', u'video_room_centre_3d_z_median_lag_5', u'video_room_centre_3d_z_median_lag_6', u'video_room_centre_3d_z_median_lag_7', u'video_room_centre_3d_z_median_lag_8', u'video_room_centre_3d_z_median_lag_9', u'probability_of_value_study_lag_7', u'probability_of_value_study_lag_6', u'probability_of_value_study_lag_5', u'probability_of_value_study_lag_4', u'probability_of_value_study_lag_3', u'probability_of_value_study_lag_2', u'probability_of_value_study_lag_1', u'probability_of_value_study_lag_9', u'probability_of_value_study_lag_8', u'acceleration_x_std', u'probability_of_value_kitchen', u'rssi_Study_AP_max', u'rssi_Upstairs_AP_std_lag_5', u'probability_of_value_hall_bas_lag_5', u'probability_of_value_hall_bas_lag_4', u'probability_of_value_hall_bas_lag_7', u'probability_of_value_hall_bas_lag_6', u'probability_of_value_hall_bas_lag_1', u'video_room_centre_2d_x_length_lag_8', u'video_room_centre_3d_z_mean_lag_9', u'probability_of_value_hall_bas_lag_2', u'video_room_centre_3d_z_mean_lag_7', u'video_room_centre_3d_z_mean_lag_6', u'video_room_bb_2d_tl_y_min_lag_4', u'video_room_centre_2d_x_length_lag_6', u'video_room_bb_2d_tl_y_min_lag_2', u'video_room_centre_3d_z_mean_lag_2', u'video_room_centre_2d_x_length_lag_3', u'video_room_bb_2d_tl_y_min_lag_1', u'acceleration_z_max_lag_1', u'acceleration_z_max_lag_2', u'acceleration_z_max_lag_3', u'acceleration_z_max_lag_4', u'acceleration_z_max_lag_5', u'acceleration_z_max_lag_6', u'acceleration_z_max_lag_7', u'acceleration_z_max_lag_8', u'acceleration_z_max_lag_9', u'video_room_bb_3d_flt_x_max_lag_10', u'rssi_Upstairs_AP_mean_lag_10', u'video_room_centre_3d_x_min_lag_10', u'video_room_centre_3d_y_std_lag_10', u'video_room_bb_2d_tl_x_max_lag_9', u'video_room_bb_2d_tl_x_max_lag_8', u'video_room_bb_2d_tl_x_max_lag_5', u'video_room_bb_2d_tl_x_max_lag_4', u'video_room_bb_2d_tl_x_max_lag_7', u'video_room_bb_2d_tl_x_max_lag_6', u'video_room_bb_2d_tl_x_max_lag_1', u'video_room_bb_2d_tl_x_max_lag_3', u'video_room_bb_2d_tl_x_max_lag_2', u'video_room_bb_2d_br_x_min', u'rssi_Study_AP_max_lag_10', u'acceleration_z_max', u'video_room_centre_2d_x_median', u'video_room_bb_3d_flt_x_mean_lag_9', u'video_room_bb_3d_flt_x_mean_lag_8', u'video_room_bb_3d_flt_x_mean_lag_1', u'video_room_bb_3d_flt_x_mean_lag_3', u'video_room_bb_3d_flt_x_mean_lag_2', u'video_room_bb_3d_flt_x_mean_lag_5', u'video_room_bb_3d_flt_x_mean_lag_4', u'video_room_bb_3d_flt_x_mean_lag_7', u'video_room_bb_3d_flt_x_mean_lag_6', u'probability_of_value_stairs', u'video_room_bb_3d_flt_z_median_lag_4', u'video_room_bb_3d_flt_z_median_lag_5', u'video_room_bb_3d_flt_z_median_lag_6', u'video_room_bb_3d_flt_z_median_lag_7', u'video_room_bb_3d_flt_z_median_lag_1', u'video_room_bb_3d_flt_z_median_lag_2', u'video_room_bb_3d_flt_z_median_lag_3', u'video_room_bb_3d_flt_z_median_lag_8', u'video_room_bb_3d_flt_z_median_lag_9', u'video_room_bb_3d_flt_z_min_lag_10', u'acceleration_z_mean', u'video_room_bb_3d_brb_z_mean_lag_10', u'video_room_bb_3d_brb_z_max_lag_9', u'video_room_bb_3d_brb_z_max_lag_8', u'video_room_bb_3d_brb_z_max_lag_5', u'video_room_bb_3d_brb_z_max_lag_4', u'video_room_bb_3d_brb_z_max_lag_7', u'video_room_bb_3d_brb_z_max_lag_6', u'video_room_bb_3d_brb_z_max_lag_1', u'video_room_bb_3d_brb_z_max_lag_3', u'video_room_bb_3d_brb_z_max_lag_2', u'acceleration_y_max_lag_10', u'video_room_bb_3d_brb_x_mean_lag_10', u'room_angle_turn_x', u'video_room_centre_2d_y_median_lag_1', u'video_room_centre_2d_y_median_lag_2', u'video_room_centre_2d_y_median_lag_3', u'video_room_centre_2d_y_median_lag_4', u'video_room_centre_2d_y_median_lag_5', u'video_room_centre_2d_y_median_lag_6', u'video_room_centre_2d_y_median_lag_7', u'video_room_centre_2d_y_median_lag_8', u'video_room_centre_2d_y_median_lag_9', u'pir_lag_10', u'video_room_bb_2d_br_y_max_lag_10', u'video_room_centre_3d_x_median_lag_2', u'video_room_centre_3d_x_median_lag_3', u'video_room_centre_3d_x_median_lag_1', u'video_room_centre_3d_x_median_lag_6', u'video_room_centre_3d_x_median_lag_7', u'video_room_centre_3d_x_median_lag_4', u'video_room_centre_3d_x_median_lag_5', u'video_room_centre_3d_x_median_lag_8', u'video_room_centre_3d_x_median_lag_9', u'video_room_centre_3d_y_mean_lagdiff', u'video_room_bb_2d_br_x_mean', u'video_room_centre_2d_y_min_lag_7', u'video_room_centre_2d_y_min_lag_6', u'video_room_centre_2d_y_min_lag_5', u'video_room_centre_2d_y_min_lag_4', u'video_room_centre_2d_y_min_lag_3', u'video_room_centre_2d_y_min_lag_2', u'video_room_centre_2d_y_min_lag_1', u'video_room_centre_2d_y_min_lag_9', u'video_room_centre_2d_y_min_lag_8', u'video_room_centre_3d_y_median', u'video_room_bb_2d_tl_x_mean_lag_9', u'video_room_bb_2d_tl_x_mean_lag_8', u'video_room_bb_2d_tl_x_mean_lag_7', u'video_room_bb_2d_tl_x_mean_lag_6', u'video_room_bb_2d_tl_x_mean_lag_5', u'video_room_bb_2d_tl_x_mean_lag_4', u'video_room_bb_2d_tl_x_mean_lag_3', u'video_room_bb_2d_tl_x_mean_lag_2', u'video_room_bb_2d_tl_x_mean_lag_1', u'video_room_centre_3d_y_mean_lag_10', u'video_room_centre_2d_y_std_lag_9', u'probability_of_value_hall_haut_lag_9', u'video_room_bb_3d_brb_x_min_lag_1', u'video_room_centre_2d_y_std_lag_1', u'video_room_bb_3d_brb_x_min_lag_3', u'video_room_bb_3d_brb_x_min_lag_2', u'video_room_centre_2d_y_std_lag_4', u'video_room_bb_3d_brb_x_min_lag_4', u'video_room_centre_2d_y_std_lag_6', u'video_room_bb_3d_brb_x_min_lag_6', u'probability_of_value_hall_haut_lag_2', u'probability_of_value_hall_haut_lag_3', u'video_room_bb_3d_flt_y_mean_lag_10', u'video_room_centre_3d_y_mean_lagdiff_lagdiff', u'rssi_Upstairs_AP_min_lag_1', u'rssi_Upstairs_AP_min_lag_2', u'rssi_Upstairs_AP_min_lag_3', u'rssi_Upstairs_AP_min_lag_4', u'rssi_Upstairs_AP_min_lag_5', u'rssi_Upstairs_AP_min_lag_6', u'rssi_Upstairs_AP_min_lag_7', u'rssi_Upstairs_AP_min_lag_8', u'rssi_Upstairs_AP_min_lag_9', u'video_room_centre_2d_y_length_lag_6', u'video_room_centre_2d_y_length_lag_7', u'video_room_centre_2d_y_length_lag_4', u'video_room_centre_2d_y_length_lag_5', u'video_room_centre_2d_y_length_lag_2', u'video_room_centre_2d_y_length_lag_3', u'video_room_centre_2d_y_length_lag_1', u'video_room_centre_2d_y_length_lag_8', u'video_room_centre_2d_y_length_lag_9', u'video_room_bb_3d_flt_z_max_lag_10', u'rssi_Lounge_AP_std', u'probability_of_value_toilet_lag_6', u'probability_of_value_toilet_lag_7', u'probability_of_value_toilet_lag_4', u'probability_of_value_toilet_lag_5', u'probability_of_value_toilet_lag_2', u'probability_of_value_toilet_lag_3', u'rssi_Upstairs_AP_min', u'probability_of_value_toilet_lag_1', u'video_room_bb_3d_brb_x_max', u'probability_of_value_toilet_lag_8', u'probability_of_value_toilet_lag_9', u'video_room_bb_3d_flt_y_min', u'video_room_centre_2d_y_std', u'video_room_bb_3d_brb_y_min', u'video_room_centre_3d_z_mean_lag_8', u'acceleration_y_mean_lag_10', u'video_room_bb_2d_tl_y_max_lag_8', u'video_room_bb_2d_tl_y_max_lag_9', u'video_room_bb_2d_tl_y_max_lag_4', u'video_room_bb_2d_tl_y_max_lag_5', u'video_room_bb_2d_tl_y_max_lag_6', u'video_room_bb_2d_tl_y_max_lag_7', u'video_room_bb_2d_tl_y_max_lag_1', u'video_room_bb_2d_tl_y_max_lag_2', u'video_room_bb_2d_tl_y_max_lag_3', u'acceleration_y_max', u'pir', u'video_room_bb_3d_flt_z_max_lag_1', u'video_room_bb_3d_flt_z_max_lag_3', u'video_room_bb_3d_flt_z_max_lag_2', u'video_room_bb_3d_flt_z_max_lag_5', u'video_room_bb_3d_flt_z_max_lag_4', u'video_room_bb_3d_flt_z_max_lag_7', u'video_room_bb_3d_flt_z_max_lag_6', u'video_room_bb_3d_flt_z_max_lag_9', u'video_room_bb_3d_flt_z_max_lag_8', u'rssi_Upstairs_AP_mean', u'rssi_Kitchen_AP_max_lag_8', u'rssi_Kitchen_AP_max_lag_9', u'rssi_Kitchen_AP_max_lag_2', u'rssi_Kitchen_AP_max_lag_3', u'rssi_Kitchen_AP_max_lag_1', u'rssi_Kitchen_AP_max_lag_6', u'rssi_Kitchen_AP_max_lag_7', u'rssi_Kitchen_AP_max_lag_4', u'rssi_Kitchen_AP_max_lag_5', u'video_room_centre_3d_y_min', u'acceleration_y_std_lag_10']
columns_to_keep_lead = [col for col in ml_dataset.columns if 'lead' in col]
columns_to_keep = columns_to_keep + columns_to_keep_lead            
answer_for_crossval = ml_dataset[columns_target]
                   
## Start of ml_dataset preprocessing
# Restrict ml_dataset to the features that will be used by xgboost
ml_dataset = ml_dataset[columns_to_keep]                  
         
# Map the target variable
target_map={}
for index,columns_name in enumerate(columns_target,start=0):
    target_map[columns_name]=index
ml_dataset['__target__'] = ml_dataset['target'].map(str).map(target_map)
del ml_dataset['target']

# Remove rows for which the target is unknown.
indices = ~ml_dataset['__target__'].isnull()
ml_dataset = ml_dataset[indices]
answer_for_crossval = answer_for_crossval[indices]
cv_df = cv_df[indices]
ml_dataset = ml_dataset.reset_index(drop=True)
answer_for_crossval = answer_for_crossval.reset_index(drop=True)
cv_df = cv_df.reset_index(drop=True)

# Fill missing values of ml_dataset
ml_dataset = ml_dataset.fillna(-99999.0)

# Dummifiy certain variables of ml_dataset
LIMIT_DUMMIES = 1000
categorical_to_dummy_encode = [u'rssi_Study_AP_median_bool', u'pir_lag_1', u'pir_lag_2', u'pir_lag_3', u'pir_lag_4', u'pir_lag_5', u'pir_lag_6', u'pir_lag_7', u'pir_lag_8', u'pir_lag_9', u'video_room', u'video_room_lag_10', u'rssi_Lounge_AP_median_bool', u'video_room_lag_5', u'video_room_lag_4', u'video_room_lag_7', u'video_room_lag_6', u'video_room_lag_1', u'video_room_lag_3', u'video_room_lag_2', u'video_room_lag_9', u'video_room_lag_8', u'rssi_Upstairs_AP_median_bool', u'rssi_Kitchen_AP_median_bool', u'pir_lag_10', u'pir',u'pir_lead_1', u'pir_lead_2', u'pir_lead_3', u'pir_lead_4', u'pir_lead_5', u'pir_lead_6', u'pir_lead_7', u'pir_lead_8', u'pir_lead_9', u'video_room_lead_10',  u'video_room_lead_5', u'video_room_lead_4', u'video_room_lead_7', u'video_room_lead_6', u'video_room_lead_1', u'video_room_lead_3', u'video_room_lead_2', u'video_room_lead_9', u'video_room_lead_8',u'pir_lead_10']
def select_dummy_values(ml_dataset, features):
    dummy_values = {}
    for feature in categorical_to_dummy_encode:
        values = [
            value
            for (value, _) in Counter(ml_dataset[feature]).most_common(LIMIT_DUMMIES)
        ]
        dummy_values[feature] = values
    return dummy_values
DUMMY_VALUES = select_dummy_values(ml_dataset, categorical_to_dummy_encode)
def dummy_encode_dataframe(df):
    for (feature, dummy_values) in DUMMY_VALUES.items():
        for dummy_value in dummy_values:
            dummy_name = u'%s_value_%s' % (feature, unicode(dummy_value))
            df[dummy_name] = (df[feature] == dummy_value).astype(float)
        del df[feature]
        print 'Dummy-encoded feature %s' % feature
dummy_encode_dataframe(ml_dataset)

# Split ml_dataset between the features (X) and target variable (Y)
ml_dataset_X = ml_dataset.drop('__target__', axis=1)
ml_dataset_Y = ml_dataset['__target__']
                   
## End of ml_dataset preprocessing
                   
# We will gridsearch the best xgboost parameters in order to predict the target: to do so, we use a validation set consisting of users 6 and 10          
valid_vals = [6,10]
test = cv_df[cv_df["original_dataset"].isin(valid_vals)].index
train = cv_df[-cv_df["original_dataset"].isin(valid_vals)].index                      

X_train = ml_dataset_X.loc[train]
y_train = ml_dataset_Y.loc[train]
X_valid = ml_dataset_X.loc[test]
y_valid = ml_dataset_Y.loc[test]
cvprobs = answer_for_crossval.loc[test]
                      
# During the gridsearch, we try to find the parameters that minimize brierscore of predictions: we define the brier score
def brier_score(targets, predicted, weights): 
    return np.power(targets - predicted, 2.0).dot(weights).mean()

class_weights = [1.35298455691, 1.38684574053, 1.59587388404, 1.35318713948, 0.347783666015
                 , 0.661081706198, 1.04723628621, 0.398865222651, 0.207586320237, 1.50578335208
                 , 0.110181365961, 1.07803284435, 1.36560417316, 1.17024113802, 1.1933637414
                 , 1.1803704493, 1.34414875433, 1.11683830693, 1.08083910312, 0.503152249073]                      

## Start of gridsearch
score = 100000    
n_estimators = 10000000
lr =  0.05
early_stopping_rounds = 40

for md in [3,5] :
    for mcw in [5, 7]:
        for cby in [0.9,1] : 
            for sub in  [1] : 
            
                print 'doing : '
                print 'max depth', md
                print 'mcw', mcw
                print 'col sample', cby
                print 'subsample', sub
            
                clf = xgb.XGBClassifier( n_estimators=n_estimators
                                        , objective = 'multi:softprob'
                                        , learning_rate=lr
                                        , max_depth=md
                                        , min_child_weight  = mcw
                                        , subsample=sub
                                        , colsample_bytree=cby
                                        , missing = -99999.0 
                                )
                
                eval_set  = [(X_train,y_train), (X_valid,y_valid)]
                clf.fit(X_train, y_train, eval_set=eval_set, eval_metric="mlogloss", early_stopping_rounds=early_stopping_rounds)
                preds = clf.predict_proba(X_valid)
                newscore = brier_score(cvprobs, preds, class_weights)
                
                print "nbtrees",clf.best_iteration
                
                if newscore <= score : 
                    score = newscore
                    bestmodel = clf
                    print 'mybestmodel'
                    print md, mcw, cby, sub, score
                    print "nb trees : ", clf.best_iteration
                    print "loss : ", clf.best_score

## End of gridsearch: we need to read the logs to read the optimal parameters to use in xgboost: look for the last apparition of 'mybestmodel'
