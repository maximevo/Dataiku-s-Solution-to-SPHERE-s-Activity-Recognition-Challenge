# -*- coding: utf-8 -*-

import pandas as pd, numpy as np, sklearn as sk, pickle as pkl
import csv,itertools,random
from sklearn.cross_validation import StratifiedKFold, KFold
from sklearn.linear_model import LogisticRegression
from sklearn.preprocessing import LabelEncoder
from sklearn import metrics
from sklearn.neighbors import KNeighborsClassifier
from sklearn.naive_bayes import GaussianNB
from sklearn.ensemble import RandomForestClassifier, ExtraTreesClassifier, GradientBoostingClassifier
from sklearn import linear_model
from collections import defaultdict, Counter
import xgboost as xgb
import os


#########
# The goal of this section of code is to generate predictions for 10 baselearners. Later on, we will stack their predictions.
#########


def save(model, name):
    models_path = os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(__file__))), 'models/Base_learners')
    
    pkl.dump(model, open( models_path+"/"+name+".p", "wb" ) )
    print name+" saved"
    
def save_dataframe(df, name):
    models_path = os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(__file__))), 'models/Base_learners')
    
    df.to_pickle(models_path+"/"+name+".pkl")
    print name+" saved"

##################################################### List of base classifiers here
clfs = [      
       xgb.XGBClassifier(n_estimators= 227, objective = 'multi:softprob', learning_rate= 0.05
                                        , max_depth=5, min_child_weight  = 7, subsample=1
                                        , colsample_bytree= 1, missing = -99999.0)
       ,GaussianNB()
       ,xgb.XGBClassifier(n_estimators= 145, objective = 'multi:softprob', learning_rate= 0.05
                                        , max_depth=5, min_child_weight  = 7, subsample=0.9
                                        , colsample_bytree= 1, missing = -99999.0)       
       ,RandomForestClassifier(n_estimators = 250, criterion = 'gini')
       ,RandomForestClassifier(n_estimators = 500, n_jobs = 5,max_depth= 15, min_samples_leaf = 1)
       ,ExtraTreesClassifier(n_estimators=500,random_state=0)
       ,linear_model.LogisticRegression(C=1.0, penalty='l1', tol=0.1)
       ,linear_model.LogisticRegression(C=10, penalty='l1', tol=0.1)
       ,linear_model.LogisticRegression(C=1.0, penalty='l2', tol=0.01)
       ,linear_model.LogisticRegression(C=10, penalty='l2', tol=0.01)

                       ]
#####################################################

n_folds = 5

input_path_1 = os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(__file__))), 'data/processed/columns_test_with_feature_engineering.csv')
dtest = pd.read_csv(filepath_or_buffer = input_path_1,encoding='utf-8')
input_path_2 = os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(__file__))), 'data/processed/columns_train_with_feature_engineering.csv')
dtrain = pd.read_csv(filepath_or_buffer = input_path_2,encoding='utf-8')

##################################################### Start preparation of dtrain and dtest
columns_target=['a_ascend','a_descend','a_jump','a_loadwalk','a_walk','p_bent','p_kneel','p_lie','p_sit','p_squat','p_stand','t_bend',
               't_kneel_stand','t_lie_sit','t_sit_lie','t_sit_stand','t_stand_kneel','t_stand_sit','t_straighten','t_turn']
columns_to_keep = ['time_since_change_of_record_id','time_since_change_of_video_room',u'video_room_centre_2d_y_mean', u'video_room_centre_2d_y_length_lag_10', u'rssi_Kitchen_AP_min', u'video_room_bb_3d_flt_z_median_lag_10', u'rssi_Lounge_AP_max', u'video_room_bb_3d_flt_x_min_lag_10', u'acceleration_x_std_lag_9', u'acceleration_x_std_lag_8', u'acceleration_x_std_lag_3', u'acceleration_x_std_lag_2', u'acceleration_x_std_lag_1', u'acceleration_x_std_lag_7', u'acceleration_x_std_lag_6', u'acceleration_x_std_lag_5', u'acceleration_x_std_lag_4', u'rssi_Study_AP_mean_lag_10', u'acceleration_y_min_lag_10', u'video_room_centre_3d_x_min', u'video_room_centre_3d_x_median_lag_10', u'video_room_centre_2d_x_median_lag_8', u'probability_of_value_hall_bas_lag_10', u'rssi_Kitchen_AP_std_lag_9', u'rssi_Kitchen_AP_std_lag_8', u'rssi_Kitchen_AP_std_lag_3', u'rssi_Kitchen_AP_std_lag_2', u'rssi_Kitchen_AP_std_lag_1', u'rssi_Kitchen_AP_std_lag_7', u'rssi_Kitchen_AP_std_lag_6', u'rssi_Kitchen_AP_std_lag_5', u'rssi_Kitchen_AP_std_lag_4', u'video_room_centre_3d_x_mean_lagdiff_lagdiff', u'video_room_centre_2d_y_max_lag_10', u'video_room_bb_2d_br_x_mean_lag_3', u'video_room_bb_2d_br_x_mean_lag_2', u'video_room_bb_2d_br_x_mean_lag_1', u'video_room_bb_2d_br_x_mean_lag_7', u'video_room_bb_2d_br_x_mean_lag_6', u'video_room_bb_2d_br_x_mean_lag_5', u'video_room_bb_2d_br_x_mean_lag_4', u'video_room_bb_2d_br_x_mean_lag_9', u'video_room_bb_2d_br_x_mean_lag_8', u'acceleration_z_std_lag_1', u'video_room_bb_3d_brb_z_max', u'acceleration_y_mean_lag_9', u'acceleration_y_mean_lag_8', u'video_room_bb_3d_flt_y_min_lag_7', u'acceleration_y_mean', u'video_room_centre_3d_y_median_lag_1', u'video_room_bb_3d_flt_y_median_lag_9', u'video_room_bb_3d_flt_y_median_lag_8', u'video_room_bb_3d_flt_y_median_lag_5', u'video_room_bb_3d_flt_y_median_lag_4', u'video_room_bb_3d_flt_y_median_lag_7', u'video_room_bb_3d_flt_y_median_lag_6', u'video_room_bb_3d_flt_y_median_lag_1', u'video_room_bb_3d_flt_y_median_lag_3', u'video_room_bb_3d_flt_y_median_lag_2', u'video_room_bb_3d_brb_z_std_lag_10', u'video_room_centre_3d_z_median_lag_10', u'video_room_bb_3d_flt_y_min_lag_1', u'acceleration_y_mean_lag_5', u'acceleration_y_mean_lag_4', u'video_room_bb_3d_brb_x_length', u'rssi_Upstairs_AP_mean_lag_8', u'rssi_Upstairs_AP_mean_lag_9', u'rssi_Upstairs_AP_mean_lag_7', u'rssi_Upstairs_AP_mean_lag_4', u'rssi_Upstairs_AP_mean_lag_5', u'rssi_Upstairs_AP_mean_lag_2', u'rssi_Upstairs_AP_mean_lag_3', u'rssi_Upstairs_AP_mean_lag_1', u'video_room_centre_3d_x_std_lag_8', u'video_room_centre_3d_x_std_lag_9', u'video_room_bb_3d_flt_x_std', u'video_room_centre_3d_x_std_lag_2', u'video_room_centre_3d_x_std_lag_3', u'video_room_centre_3d_x_std_lag_1', u'video_room_centre_3d_x_std_lag_6', u'video_room_centre_3d_x_std_lag_7', u'video_room_centre_3d_x_std_lag_4', u'video_room_centre_3d_x_std_lag_5', u'video_room_centre_2d_x_min', u'video_room_bb_3d_brb_z_std_lag_8', u'video_room_bb_3d_brb_x_length_lag_5', u'rssi_Study_AP_median', u'video_room_bb_3d_brb_y_std_lag_7', u'video_room_bb_3d_flt_y_std_lag_10', u'video_room_bb_2d_br_y_median_lag_7', u'video_room_bb_2d_br_y_median_lag_6', u'video_room_bb_2d_br_y_median_lag_5', u'video_room_bb_2d_br_y_median_lag_4', u'video_room_bb_2d_br_y_median_lag_3', u'video_room_bb_2d_br_y_median_lag_2', u'video_room_bb_2d_br_y_median_lag_1', u'video_room_bb_3d_brb_z_std_lag_4', u'video_room_bb_2d_br_y_median_lag_9', u'video_room_bb_3d_brb_z_std_lag_5', u'video_room_bb_3d_brb_x_std_lag_10', u'video_room_bb_2d_tl_y_median_lag_9', u'video_room_bb_2d_tl_y_median_lag_8', u'video_room_bb_2d_tl_y_median_lag_3', u'video_room_bb_2d_tl_y_median_lag_2', u'video_room_bb_2d_tl_y_mean', u'video_room_bb_2d_tl_y_median_lag_7', u'video_room_bb_2d_tl_y_median_lag_6', u'video_room_bb_2d_tl_y_median_lag_5', u'video_room_bb_2d_tl_y_median_lag_4', u'probability_of_value_study_lag_10', u'video_room_bb_3d_flt_y_min_lag_10', u'video_room_bb_3d_brb_y_length_lag_10', u'rssi_Upstairs_AP_median_lag_9', u'rssi_Upstairs_AP_median_lag_8', u'video_room_centre_3d_y_std_lag_9', u'video_room_centre_3d_y_std_lag_8', u'rssi_Upstairs_AP_median_lag_5', u'rssi_Upstairs_AP_median_lag_4', u'video_room_centre_3d_y_std_lag_5', u'video_room_centre_3d_y_std_lag_4', u'rssi_Upstairs_AP_median_lag_1', u'video_room_centre_3d_y_std_lag_2', u'video_room_centre_3d_y_std_lag_1', u'rssi_Upstairs_AP_median_lag_2', u'video_room_centre_3d_x_std_lag_10', u'video_room_bb_3d_flt_x_mean', u'video_room_bb_2d_tl_x_std_lag_10', u'video_room_centre_3d_z_max_lag_9', u'video_room_centre_3d_z_max_lag_8', u'video_room_centre_3d_z_max_lag_5', u'video_room_centre_3d_z_max_lag_4', u'video_room_centre_3d_z_max_lag_7', u'video_room_centre_3d_z_max_lag_6', u'video_room_centre_3d_z_max_lag_1', u'video_room_centre_3d_z_max_lag_3', u'video_room_centre_3d_z_max_lag_2', u'video_room_bb_3d_brb_x_length_lag_10', u'acceleration_y_median_lag_6', u'acceleration_y_median_lag_7', u'acceleration_y_median_lag_4', u'acceleration_y_median_lag_5', u'acceleration_y_median_lag_2', u'acceleration_y_median_lag_3', u'acceleration_y_median_lag_1', u'acceleration_y_median_lag_8', u'acceleration_y_median_lag_9', u'target', u'video_room_centre_3d_z_min_lag_7', u'video_room_centre_3d_z_min_lag_6', u'video_room_centre_3d_z_min_lag_5', u'video_room_centre_3d_z_min_lag_4', u'video_room_centre_3d_z_min_lag_3', u'video_room_centre_3d_z_min_lag_2', u'video_room_centre_3d_z_min_lag_1', u'video_room_centre_3d_z_min_lag_9', u'video_room_centre_3d_z_min_lag_8', u'rssi_Study_AP_std_lag_10', u'rssi_Upstairs_AP_max_lag_10', u'acceleration_x_min', u'rssi_Lounge_AP_median_lag_9', u'video_room_bb_2d_tl_x_std', u'video_room_bb_3d_brb_y_std', u'video_room_bb_3d_brb_y_max_lag_3', u'probability_of_value_study', u'video_room_bb_3d_brb_x_median_lag_2', u'video_room_bb_3d_brb_x_median_lag_3', u'video_room_bb_3d_flt_z_min_lag_1', u'video_room_bb_3d_brb_x_median_lag_1', u'video_room_bb_3d_brb_x_median_lag_6', u'video_room_bb_3d_brb_x_median_lag_7', u'video_room_bb_3d_brb_x_median_lag_4', u'video_room_bb_3d_brb_x_median_lag_5', u'video_room_bb_3d_brb_x_median_lag_8', u'video_room_bb_3d_brb_x_median_lag_9', u'video_room_bb_3d_flt_y_std_lag_9', u'video_room_bb_3d_flt_y_std_lag_8', u'video_room_bb_3d_flt_y_std_lag_3', u'video_room_bb_3d_flt_y_std_lag_2', u'video_room_bb_3d_flt_y_std_lag_1', u'video_room_bb_3d_flt_y_std_lag_7', u'video_room_bb_3d_flt_y_std_lag_6', u'video_room_bb_3d_flt_y_std_lag_5', u'video_room_bb_3d_flt_y_std_lag_4', u'video_room_centre_3d_y_mean_lag_6', u'video_room_centre_3d_y_mean_lag_7', u'video_room_centre_3d_y_mean_lag_4', u'video_room_centre_3d_y_mean_lag_5', u'video_room_centre_3d_y_mean_lag_2', u'video_room_centre_3d_y_mean_lag_3', u'video_room_centre_3d_y_mean_lag_1', u'rssi_Upstairs_AP_std_lag_3', u'rssi_Upstairs_AP_std_lag_2', u'rssi_Upstairs_AP_std_lag_1', u'rssi_Upstairs_AP_std_lag_7', u'rssi_Upstairs_AP_std_lag_6', u'video_room_centre_3d_y_mean_lag_8', u'video_room_centre_3d_y_mean_lag_9', u'acceleration_z_min_lag_1', u'acceleration_z_min_lag_6', u'video_room_centre_2d_x_length_lagdiff', u'video_room_centre_3d_z_mean_lagdiff', u'acceleration_z_min_lag_7', u'video_room_bb_2d_tl_y_std_lag_9', u'video_room_bb_2d_tl_y_std_lag_8', u'video_room_bb_2d_tl_y_std_lag_5', u'video_room_bb_2d_tl_y_std_lag_4', u'video_room_bb_2d_tl_y_std_lag_7', u'video_room_bb_2d_tl_y_std_lag_6', u'video_room_bb_2d_tl_y_std_lag_1', u'video_room_bb_2d_tl_y_std_lag_3', u'video_room_bb_2d_tl_y_std_lag_2', u'rssi_Kitchen_AP_median', u'rssi_Upstairs_AP_median_lag_6', u'video_room_centre_2d_x_length_lag_9', u'probability_of_value_hall_bas_lag_3', u'video_room_bb_2d_tl_y_min_lag_9', u'video_room_bb_2d_tl_x_min', u'video_room_centre_2d_x_length_lag_4', u'video_room_centre_3d_z_mean_lag_5', u'video_room_centre_3d_z_mean_lag_4', u'video_room_centre_3d_z_mean_lag_3', u'probability_of_value_hall_bas_lag_8', u'video_room_centre_3d_z_mean_lag_1', u'video_room_centre_2d_x_length_lag_2', u'rssi_Lounge_AP_std_lag_4', u'rssi_Lounge_AP_std_lag_5', u'rssi_Lounge_AP_std_lag_6', u'rssi_Lounge_AP_std_lag_7', u'rssi_Lounge_AP_std_lag_1', u'rssi_Lounge_AP_std_lag_2', u'rssi_Lounge_AP_std_lag_3', u'rssi_Lounge_AP_std_lag_8', u'rssi_Lounge_AP_std_lag_9', u'probability_of_value_living_lag_10', u'video_room_centre_2d_x_std', u'video_room_centre_2d_x_std_lag_5', u'video_room_centre_2d_x_std_lag_4', u'video_room_centre_2d_x_std_lag_7', u'video_room_centre_2d_x_std_lag_6', u'video_room_centre_2d_x_std_lag_1', u'video_room_centre_2d_x_std_lag_3', u'video_room_centre_2d_x_std_lag_2', u'acceleration_y_mean_lag_1', u'acceleration_y_mean_lag_3', u'acceleration_y_mean_lag_2', u'video_room_centre_2d_x_std_lag_9', u'video_room_centre_2d_x_std_lag_8', u'acceleration_y_mean_lag_7', u'acceleration_y_mean_lag_6', u'video_room_centre_2d_y_max_lag_8', u'video_room_centre_2d_x_mean', u'probability_of_value_bed2_lag_7', u'video_room_bb_3d_brb_z_min_lag_7', u'video_room_bb_3d_brb_z_min_lag_6', u'video_room_bb_3d_brb_z_min_lag_5', u'video_room_bb_3d_brb_z_min_lag_4', u'video_room_bb_3d_brb_z_min_lag_3', u'video_room_bb_3d_brb_z_min_lag_2', u'video_room_bb_3d_brb_z_min_lag_1', u'video_room_centre_2d_y_max_lag_1', u'video_room_bb_3d_brb_z_min_lag_9', u'video_room_bb_3d_brb_z_min_lag_8', u'rssi_Lounge_AP_max_lag_1', u'rssi_Lounge_AP_max_lag_3', u'rssi_Lounge_AP_max_lag_2', u'rssi_Lounge_AP_max_lag_5', u'rssi_Lounge_AP_max_lag_4', u'rssi_Lounge_AP_max_lag_7', u'rssi_Lounge_AP_max_lag_6', u'rssi_Lounge_AP_max_lag_9', u'rssi_Lounge_AP_max_lag_8', u'video_room_bb_2d_tl_y_mean_lag_10', u'rssi_Study_AP_median_bool', u'probability_of_value_stairs_lag_10', u'video_room_centre_2d_x_min_lag_10', u'video_room_centre_2d_x_median_lag_10', u'video_room_bb_2d_br_x_std_lag_10', u'video_room_bb_3d_flt_y_mean_lag_2', u'video_room_bb_3d_flt_y_mean_lag_3', u'video_room_bb_3d_flt_y_mean_lag_1', u'video_room_bb_3d_flt_y_mean_lag_6', u'video_room_bb_3d_flt_y_mean_lag_7', u'video_room_bb_3d_flt_y_mean_lag_4', u'video_room_bb_3d_flt_y_mean_lag_5', u'video_room_bb_3d_flt_y_mean_lag_8', u'video_room_bb_3d_flt_y_mean_lag_9', u'video_room_bb_2d_tl_x_min_lag_10', u'video_room_centre_3d_z_std_lag_8', u'video_room_centre_3d_z_std_lag_9', u'video_room_centre_2d_x_min_lag_8', u'video_room_centre_2d_x_min_lag_9', u'video_room_centre_2d_x_min_lag_6', u'video_room_centre_2d_x_min_lag_7', u'video_room_centre_3d_z_std_lag_2', u'video_room_centre_3d_z_std_lag_3', u'video_room_centre_3d_z_std_lag_4', u'video_room_centre_3d_z_std_lag_5', u'video_room_centre_3d_z_std_lag_6', u'video_room_centre_3d_z_std_lag_7', u'video_room_bb_2d_br_y_std_lag_9', u'video_room_bb_2d_br_y_std_lag_8', u'video_room_bb_2d_br_y_std_lag_1', u'video_room_bb_2d_br_y_std_lag_3', u'video_room_bb_2d_br_y_std_lag_2', u'video_room_bb_2d_br_y_std_lag_5', u'video_room_bb_2d_br_y_std_lag_4', u'video_room_bb_2d_br_y_std_lag_7', u'video_room_bb_2d_br_y_std_lag_6', u'video_room_bb_2d_tl_y_max_lag_10', u'rssi_Kitchen_AP_std_lag_10', u'acceleration_y_min_lag_5', u'acceleration_y_min_lag_4', u'acceleration_y_min_lag_7', u'acceleration_y_min_lag_6', u'acceleration_x_min_lag_8', u'acceleration_x_min_lag_9', u'acceleration_y_min_lag_3', u'acceleration_y_min_lag_2', u'acceleration_x_min_lag_5', u'acceleration_x_min_lag_6', u'acceleration_x_min_lag_7', u'acceleration_y_min_lag_9', u'acceleration_x_min_lag_1', u'acceleration_x_min_lag_2', u'acceleration_x_min_lag_3', u'video_room_bb_2d_tl_x_min_lag_7', u'video_room_bb_2d_tl_x_min_lag_6', u'video_room_bb_2d_tl_x_min_lag_5', u'video_room_bb_2d_tl_x_min_lag_4', u'video_room_bb_2d_tl_x_min_lag_3', u'video_room_bb_2d_tl_x_min_lag_2', u'video_room_bb_2d_tl_x_min_lag_1', u'video_room_bb_2d_tl_x_min_lag_9', u'video_room_bb_2d_tl_x_min_lag_8', u'video_room_bb_2d_tl_y_min', u'video_room_bb_3d_brb_y_std_lag_10', u'room_angle_turn_x_lag_9', u'room_angle_turn_x_lag_8', u'room_angle_turn_x_lag_3', u'room_angle_turn_x_lag_2', u'room_angle_turn_x_lag_1', u'room_angle_turn_x_lag_7', u'room_angle_turn_x_lag_6', u'room_angle_turn_x_lag_5', u'video_room_centre_3d_z_mean_lag_10', u'acceleration_x_median_lag_10', u'rssi_Study_AP_min_lag_10', u'video_room_bb_3d_brb_x_min_lag_10', u'rssi_Upstairs_AP_min_lag_10', u'video_room_bb_2d_tl_x_mean_lag_10', u'rssi_Kitchen_AP_min_lag_8', u'video_room_bb_3d_flt_x_max', u'rssi_Kitchen_AP_min_lag_1', u'rssi_Kitchen_AP_min_lag_2', u'rssi_Kitchen_AP_min_lag_3', u'rssi_Kitchen_AP_min_lag_4', u'rssi_Kitchen_AP_min_lag_5', u'rssi_Kitchen_AP_min_lag_6', u'rssi_Kitchen_AP_min_lag_7', u'rssi_Lounge_AP_max_lag_10', u'video_room_centre_2d_y_std_lag_2', u'room_angle_turn_x_lag_4', u'video_room_bb_3d_flt_y_max_lag_10', u'video_room_bb_3d_flt_x_median', u'video_room_bb_3d_flt_z_std_lag_10', u'video_room_centre_3d_z_min', u'rssi_Study_AP_mean', u'rssi_Study_AP_median_lag_10', u'video_room_centre_3d_z_std', u'room_angle_turn_x_lag_10', u'video_room_bb_3d_brb_z_std', u'video_room_bb_2d_br_y_std_lag_10', u'video_room_bb_3d_brb_z_median', u'video_room_centre_3d_x_median', u'video_room_bb_2d_br_y_mean_lag_8', u'video_room_bb_2d_br_y_mean_lag_9', u'video_room_bb_2d_br_y_mean_lag_1', u'video_room_bb_2d_br_y_mean_lag_2', u'video_room_bb_2d_br_y_mean_lag_3', u'video_room_bb_2d_br_y_mean_lag_4', u'video_room_bb_2d_br_y_mean_lag_5', u'video_room_bb_2d_br_y_mean_lag_6', u'video_room_bb_2d_br_y_mean_lag_7', u'speed_room_centre_3d_horizontal', u'video_room_centre_3d_z_std_lag_1', u'video_room_centre_2d_x_min_lag_4', u'video_room_centre_2d_x_min_lag_5', u'video_room_centre_2d_x_min_lag_2', u'video_room_centre_2d_x_min_lag_3', u'acceleration_y_median', u'video_room_centre_2d_x_min_lag_1', u'probability_of_value_bath_lag_10', u'video_room_bb_3d_brb_y_length_lag_3', u'video_room_bb_3d_brb_y_length_lag_2', u'video_room_bb_3d_brb_y_length_lag_1', u'video_room_bb_3d_brb_y_length_lag_7', u'video_room_bb_3d_brb_y_length_lag_6', u'video_room_bb_3d_brb_y_length_lag_5', u'video_room_bb_3d_brb_y_length_lag_4', u'video_room_bb_3d_brb_y_length_lag_9', u'video_room_bb_3d_brb_y_length_lag_8', u'video_room_bb_3d_flt_x_mean_lag_10', u'video_room_bb_2d_tl_x_mean', u'video_room_centre_2d_y_min', u'video_room_bb_2d_tl_x_std_lag_8', u'video_room_bb_2d_tl_x_std_lag_9', u'video_room_bb_2d_tl_x_std_lag_1', u'video_room_bb_2d_tl_x_std_lag_2', u'video_room_bb_2d_tl_x_std_lag_3', u'video_room_bb_2d_tl_x_std_lag_4', u'video_room_bb_2d_tl_x_std_lag_5', u'video_room_bb_2d_tl_x_std_lag_6', u'video_room_bb_2d_tl_x_std_lag_7', u'acceleration_x_median_lagdiff_lagdiff', u'video_room_bb_2d_tl_y_min_lag_10', u'video_room_centre_2d_y_std_lag_10', u'probability_of_value_bath_lag_4', u'probability_of_value_bath_lag_5', u'probability_of_value_bath_lag_6', u'probability_of_value_bath_lag_7', u'probability_of_value_bath_lag_1', u'probability_of_value_bath_lag_2', u'probability_of_value_bath_lag_3', u'video_room_bb_2d_br_y_median', u'probability_of_value_bath_lag_8', u'probability_of_value_bath_lag_9', u'acceleration_z_std', u'rssi_Lounge_AP_median_lag_10', u'video_room_bb_3d_brb_y_max_lag_10', u'video_room_bb_3d_flt_y_std', u'video_room_bb_2d_br_x_median_lag_10', u'video_room_bb_3d_brb_x_mean', u'video_room_bb_2d_br_y_std', u'acceleration_z_mean_lag_4', u'acceleration_z_mean_lag_5', u'acceleration_z_mean_lag_6', u'acceleration_z_mean_lag_7', u'acceleration_z_mean_lag_1', u'acceleration_z_mean_lag_2', u'acceleration_z_mean_lag_3', u'acceleration_z_mean_lag_8', u'acceleration_z_mean_lag_9', u'video_room_bb_3d_flt_x_median_lag_10', u'video_room_bb_3d_brb_x_length_lag_4', u'video_room_bb_3d_brb_z_std_lag_9', u'video_room_bb_3d_brb_x_length_lag_6', u'video_room_bb_3d_brb_x_length_lag_7', u'video_room_bb_3d_brb_x_length_lag_1', u'video_room_bb_3d_brb_x_length_lag_2', u'video_room_bb_3d_brb_x_length_lag_3', u'video_room_bb_3d_brb_z_std_lag_1', u'video_room_bb_3d_brb_z_std_lag_2', u'video_room_bb_3d_brb_z_std_lag_3', u'video_room_bb_3d_brb_x_length_lag_8', u'video_room_bb_3d_brb_x_length_lag_9', u'video_room_bb_3d_brb_z_std_lag_6', u'video_room_bb_3d_brb_z_std_lag_7', u'acceleration_z_max_lag_10', u'video_room_centre_2d_x_length', u'video_room_centre_3d_z_mean', u'acceleration_x_mean', u'rssi_Kitchen_AP_max_lag_10', u'acceleration_z_mean_lag_10', u'video_room_bb_3d_flt_y_mean', u'video_room_bb_3d_brb_y_min_lag_1', u'video_room_bb_3d_brb_y_min_lag_2', u'video_room_bb_3d_brb_y_min_lag_3', u'video_room_bb_3d_brb_y_min_lag_4', u'video_room_bb_3d_brb_y_min_lag_5', u'video_room_bb_3d_brb_y_min_lag_6', u'video_room_bb_3d_brb_y_min_lag_7', u'video_room_bb_3d_brb_y_min_lag_8', u'video_room_bb_3d_brb_y_min_lag_9', u'video_room_bb_2d_tl_x_median_lag_10', u'acceleration_room_centre_3d_vertical', u'video_room_bb_3d_flt_z_mean', u'video_room_centre_3d_z_min_lag_10', u'video_room_bb_3d_brb_y_mean', u'video_room_centre_3d_z_median', u'rssi_Lounge_AP_min_lag_10', u'video_room_bb_3d_brb_y_median', u'acceleration_y_min_lag_1', u'acceleration_x_min_lag_4', u'video_room_bb_3d_flt_z_min_lag_2', u'acceleration_y_min_lag_8', u'video_room_bb_2d_br_x_max_lag_1', u'video_room_bb_2d_br_x_max_lag_3', u'video_room_bb_2d_br_x_max_lag_2', u'video_room_bb_2d_br_x_max_lag_5', u'video_room_bb_2d_br_x_max_lag_4', u'video_room_bb_2d_br_x_max_lag_7', u'video_room_bb_2d_br_x_max_lag_6', u'video_room_bb_2d_br_x_max_lag_9', u'video_room_bb_2d_br_x_max_lag_8', u'rssi_Lounge_AP_std_lag_10', u'probability_of_value_hall_haut_lag_8', u'video_room_centre_2d_y_median_lag_10', u'rssi_Kitchen_AP_median_lag_5', u'rssi_Kitchen_AP_median_lag_4', u'rssi_Kitchen_AP_median_lag_7', u'rssi_Kitchen_AP_median_lag_6', u'rssi_Kitchen_AP_median_lag_1', u'rssi_Kitchen_AP_median_lag_3', u'rssi_Kitchen_AP_median_lag_2', u'rssi_Kitchen_AP_median_lag_9', u'rssi_Kitchen_AP_median_lag_8', u'rssi_Study_AP_min_lag_7', u'rssi_Study_AP_min_lag_6', u'rssi_Study_AP_min_lag_5', u'rssi_Study_AP_min_lag_4', u'rssi_Study_AP_min_lag_3', u'rssi_Study_AP_min_lag_2', u'rssi_Study_AP_min_lag_1', u'video_room_bb_2d_br_y_min', u'rssi_Study_AP_min_lag_9', u'rssi_Study_AP_min_lag_8', u'acceleration_y_max_lag_9', u'acceleration_y_max_lag_8', u'acceleration_y_max_lag_7', u'acceleration_y_max_lag_6', u'acceleration_y_max_lag_5', u'acceleration_y_max_lag_4', u'acceleration_y_max_lag_3', u'acceleration_y_max_lag_2', u'acceleration_y_max_lag_1', u'video_room_bb_2d_br_y_mean_lag_10', u'video_room_bb_3d_brb_x_max_lag_5', u'acceleration_z_min_lag_10', u'rssi_Kitchen_AP_min_lag_10', u'rssi_Upstairs_AP_mean_lag_6', u'video_room_centre_2d_x_max_lag_10', u'video_room_bb_3d_flt_z_max', u'video_room_bb_3d_flt_x_std_lag_10', u'pir_lag_1', u'pir_lag_2', u'pir_lag_3', u'pir_lag_4', u'pir_lag_5', u'pir_lag_6', u'pir_lag_7', u'pir_lag_8', u'pir_lag_9', u'acceleration_y_std_lag_6', u'acceleration_y_std_lag_7', u'acceleration_y_std_lag_4', u'acceleration_y_std_lag_5', u'acceleration_y_std_lag_2', u'acceleration_y_std_lag_3', u'acceleration_y_std_lag_1', u'acceleration_y_std_lag_8', u'acceleration_y_std_lag_9', u'probability_of_value_stairs_lag_9', u'probability_of_value_stairs_lag_8', u'probability_of_value_stairs_lag_7', u'probability_of_value_stairs_lag_6', u'probability_of_value_stairs_lag_5', u'probability_of_value_stairs_lag_4', u'probability_of_value_stairs_lag_3', u'probability_of_value_stairs_lag_2', u'probability_of_value_stairs_lag_1', u'video_room_bb_3d_flt_x_max_lag_9', u'video_room_bb_3d_flt_x_max_lag_8', u'video_room_bb_3d_flt_x_max_lag_7', u'video_room_bb_3d_flt_x_max_lag_6', u'video_room_bb_3d_flt_x_max_lag_5', u'video_room_bb_3d_flt_x_max_lag_4', u'video_room_bb_3d_flt_x_max_lag_3', u'video_room_bb_3d_flt_x_max_lag_2', u'video_room_bb_3d_flt_x_max_lag_1', u'video_room_centre_2d_x_mean_lag_10', u'video_room_bb_3d_flt_z_min_lag_6', u'acceleration_y_min', u'video_room_bb_3d_brb_x_length_lagdiff', u'probability_of_value_kitchen_lag_10', u'acceleration_x_median_lagdiff', u'video_room_bb_3d_flt_z_std_lag_4', u'video_room_bb_3d_flt_z_std_lag_5', u'video_room_bb_3d_flt_z_std_lag_6', u'video_room_bb_3d_flt_z_std_lag_7', u'video_room_bb_3d_flt_z_std_lag_1', u'video_room_bb_3d_flt_z_std_lag_2', u'video_room_bb_3d_flt_z_std_lag_3', u'video_room_bb_3d_flt_z_std_lag_8', u'video_room_bb_3d_flt_z_std_lag_9', u'video_room', u'video_room_centre_2d_x_mean_lag_9', u'video_room_centre_2d_y_mean_lag_9', u'video_room_centre_2d_y_mean_lag_8', u'video_room_centre_2d_y_mean_lag_7', u'video_room_centre_2d_y_mean_lag_6', u'video_room_centre_2d_y_mean_lag_5', u'video_room_centre_2d_y_mean_lag_4', u'video_room_centre_2d_y_mean_lag_3', u'video_room_centre_3d_x_max', u'video_room_centre_2d_y_mean_lag_1', u'acceleration_y_std', u'video_room_centre_3d_x_min_lag_9', u'video_room_centre_3d_x_min_lag_8', u'video_room_centre_3d_x_min_lag_1', u'video_room_centre_3d_x_min_lag_3', u'video_room_centre_3d_x_min_lag_2', u'video_room_centre_3d_x_min_lag_5', u'video_room_centre_3d_x_min_lag_4', u'video_room_centre_3d_x_min_lag_7', u'video_room_centre_3d_x_min_lag_6', u'video_room_bb_2d_br_x_std', u'video_room_bb_2d_br_x_max', u'acceleration_x_std_lag_10', u'video_room_bb_2d_br_x_max_lag_10', u'video_room_bb_2d_tl_y_mean_lag_4', u'video_room_bb_2d_tl_y_mean_lag_5', u'probability_of_value_bed2_lag_4', u'probability_of_value_bed2_lag_5', u'probability_of_value_bed2_lag_2', u'probability_of_value_bed2_lag_3', u'video_room_bb_2d_tl_y_mean_lag_2', u'probability_of_value_bed2_lag_1', u'video_room_bb_2d_tl_y_mean_lag_8', u'video_room_bb_2d_tl_y_mean_lag_9', u'probability_of_value_bed2_lag_8', u'probability_of_value_bed2_lag_9', u'probability_of_value_bath', u'video_room_bb_2d_br_x_std_lag_4', u'video_room_bb_2d_br_x_std_lag_5', u'video_room_bb_2d_br_x_std_lag_6', u'video_room_bb_2d_br_x_std_lag_7', u'video_room_bb_2d_br_x_std_lag_1', u'video_room_bb_2d_br_x_std_lag_2', u'video_room_bb_2d_br_x_std_lag_3', u'video_room_bb_2d_br_x_std_lag_8', u'video_room_bb_2d_br_x_std_lag_9', u'rssi_Kitchen_AP_mean', u'probability_of_value_kitchen_lag_2', u'probability_of_value_kitchen_lag_3', u'probability_of_value_kitchen_lag_1', u'probability_of_value_kitchen_lag_6', u'probability_of_value_kitchen_lag_7', u'probability_of_value_kitchen_lag_4', u'probability_of_value_kitchen_lag_5', u'probability_of_value_kitchen_lag_8', u'probability_of_value_kitchen_lag_9', u'rssi_Lounge_AP_min', u'video_room_centre_2d_x_length_lag_10', u'video_room_centre_2d_y_length', u'video_room_bb_2d_tl_x_median_lag_1', u'video_room_bb_2d_tl_x_median_lag_2', u'video_room_bb_3d_brb_z_min_lag_10', u'video_room_bb_2d_tl_x_median_lag_4', u'video_room_bb_2d_tl_x_median_lag_5', u'video_room_bb_2d_tl_x_median_lag_6', u'video_room_bb_2d_tl_x_median_lag_7', u'video_room_bb_2d_tl_x_median_lag_8', u'video_room_bb_2d_tl_x_median_lag_9', u'video_room_lag_10', u'video_room_bb_2d_br_x_min_lag_3', u'video_room_bb_2d_br_x_min_lag_2', u'video_room_bb_2d_br_x_min_lag_1', u'video_room_bb_2d_br_x_median_lag_8', u'video_room_bb_2d_br_x_median_lag_9', u'video_room_bb_2d_br_x_min_lag_5', u'video_room_bb_2d_br_x_min_lag_4', u'video_room_bb_2d_br_x_median_lag_4', u'video_room_bb_2d_br_x_median_lag_5', u'video_room_bb_2d_br_x_min_lag_9', u'video_room_bb_2d_br_x_median_lag_7', u'video_room_bb_2d_br_x_median_lag_1', u'video_room_bb_2d_br_x_median_lag_2', u'video_room_bb_2d_br_x_median_lag_3', u'rssi_Upstairs_AP_std_lag_4', u'video_room_bb_2d_br_y_max_lag_1', u'video_room_bb_2d_br_y_max_lag_2', u'video_room_bb_2d_br_y_max_lag_3', u'video_room_bb_2d_br_y_max_lag_4', u'video_room_bb_2d_br_y_max_lag_5', u'video_room_bb_2d_br_y_max_lag_6', u'video_room_bb_2d_br_y_max_lag_7', u'video_room_bb_2d_br_y_max_lag_8', u'video_room_bb_2d_br_y_max_lag_9', u'rssi_Upstairs_AP_median', u'video_room_bb_3d_flt_x_median_lag_6', u'video_room_bb_3d_flt_x_median_lag_7', u'video_room_bb_3d_flt_x_median_lag_4', u'video_room_bb_3d_flt_x_median_lag_5', u'video_room_bb_3d_flt_x_median_lag_2', u'video_room_bb_3d_flt_x_median_lag_3', u'video_room_bb_3d_flt_x_median_lag_1', u'video_room_bb_3d_flt_x_median_lag_8', u'video_room_bb_3d_flt_x_median_lag_9', u'video_room_bb_3d_brb_y_median_lag_9', u'video_room_bb_3d_brb_y_median_lag_8', u'video_room_bb_3d_brb_y_median_lag_1', u'video_room_bb_3d_brb_y_median_lag_3', u'video_room_bb_3d_brb_y_median_lag_2', u'video_room_bb_3d_brb_y_median_lag_5', u'video_room_bb_3d_brb_y_median_lag_4', u'video_room_bb_3d_brb_y_median_lag_7', u'video_room_bb_3d_brb_y_median_lag_6', u'acceleration_z_median_lag_10', u'video_room_centre_3d_y_median_lag_10', u'video_room_bb_3d_brb_z_median_lag_1', u'video_room_bb_3d_brb_z_median_lag_2', u'video_room_bb_3d_brb_z_median_lag_3', u'video_room_bb_3d_brb_z_median_lag_4', u'video_room_bb_3d_brb_z_median_lag_5', u'video_room_bb_3d_brb_z_median_lag_6', u'video_room_bb_3d_brb_z_median_lag_7', u'video_room_bb_3d_brb_z_median_lag_8', u'video_room_bb_3d_brb_z_median_lag_9', u'probability_of_value_hall_haut_lag_1', u'probability_of_value_hall_haut_lag_6', u'probability_of_value_hall_haut_lag_7', u'probability_of_value_hall_haut_lag_4', u'probability_of_value_hall_haut_lag_5', u'video_room_centre_3d_y_min_lag_10', u'video_room_bb_3d_flt_x_min_lag_5', u'rssi_Study_AP_std_lag_9', u'video_room_bb_3d_brb_y_median_lag_10', u'video_room_bb_2d_tl_y_median_lag_10', u'video_room_bb_3d_flt_x_min_lag_9', u'video_room_bb_3d_flt_x_min_lag_8', u'video_room_bb_2d_br_y_median_lag_8', u'acceleration_x_mean_lag_2', u'acceleration_x_mean_lag_3', u'acceleration_x_mean_lag_1', u'acceleration_x_mean_lag_6', u'acceleration_x_mean_lag_7', u'acceleration_x_mean_lag_4', u'acceleration_x_mean_lag_5', u'acceleration_x_mean_lag_8', u'acceleration_x_mean_lag_9', u'video_room_centre_3d_x_std', u'video_room_centre_2d_x_max', u'probability_of_value_hall_haut_lag_10', u'video_room_bb_2d_br_y_median_lag_10', u'video_room_bb_3d_brb_y_max_lag_8', u'video_room_bb_3d_brb_y_max_lag_9', u'acceleration_z_min_lag_2', u'video_room_bb_3d_brb_y_max_lag_2', u'video_room_bb_3d_brb_y_max_lag_1', u'video_room_bb_3d_brb_y_max_lag_6', u'video_room_bb_3d_brb_y_max_lag_7', u'video_room_bb_3d_brb_y_max_lag_4', u'video_room_bb_3d_brb_y_max_lag_5', u'acceleration_z_median', u'video_room_bb_2d_tl_y_median_lag_1', u'acceleration_z_min_lag_3', u'rssi_Upstairs_AP_median_lag_10', u'video_room_centre_3d_x_mean_lagdiff', u'rssi_Lounge_AP_median_lag_4', u'rssi_Lounge_AP_median_lag_5', u'rssi_Lounge_AP_median_lag_6', u'rssi_Lounge_AP_median_lag_7', u'video_room_centre_2d_y_max_lag_9', u'rssi_Lounge_AP_median_lag_1', u'rssi_Lounge_AP_median_lag_2', u'rssi_Lounge_AP_median_lag_3', u'video_room_centre_2d_y_max_lag_5', u'video_room_centre_2d_y_max_lag_4', u'video_room_centre_2d_y_max_lag_7', u'video_room_centre_2d_y_max_lag_6', u'rssi_Lounge_AP_median_lag_8', u'video_room_bb_3d_brb_z_mean', u'video_room_centre_2d_y_max_lag_3', u'video_room_centre_2d_y_max_lag_2', u'video_room_bb_3d_flt_y_max', u'video_room_bb_3d_flt_y_max_lag_8', u'video_room_bb_3d_flt_y_max_lag_9', u'video_room_bb_3d_flt_y_max_lag_6', u'video_room_bb_3d_flt_y_max_lag_7', u'video_room_bb_3d_flt_y_max_lag_4', u'video_room_bb_3d_flt_y_max_lag_5', u'video_room_bb_3d_flt_y_max_lag_2', u'video_room_bb_3d_flt_y_max_lag_3', u'video_room_bb_3d_flt_y_max_lag_1', u'acceleration_x_min_lag_10', u'acceleration_z_median_lag_3', u'acceleration_z_median_lag_2', u'acceleration_z_median_lag_1', u'acceleration_z_median_lag_7', u'acceleration_z_median_lag_6', u'acceleration_z_median_lag_5', u'acceleration_z_median_lag_4', u'acceleration_z_median_lag_9', u'acceleration_z_median_lag_8', u'video_room_bb_3d_brb_y_mean_lag_6', u'video_room_bb_3d_brb_y_mean_lag_7', u'video_room_bb_3d_brb_y_mean_lag_4', u'video_room_bb_3d_brb_y_mean_lag_5', u'video_room_bb_3d_brb_y_mean_lag_2', u'video_room_bb_3d_brb_y_mean_lag_3', u'video_room_bb_3d_brb_y_mean_lag_1', u'video_room_bb_3d_brb_y_max', u'video_room_bb_3d_brb_y_mean_lag_8', u'video_room_bb_3d_brb_y_mean_lag_9', u'acceleration_z_min', u'acceleration_x_median', u'acceleration_z_min_lag_5', u'rssi_Kitchen_AP_min_lag_9', u'acceleration_x_max', u'video_room_centre_3d_y_std_lag_7', u'video_room_centre_3d_y_std_lag_6', u'rssi_Upstairs_AP_median_lag_7', u'video_room_bb_3d_brb_x_min', u'rssi_Upstairs_AP_max', u'video_room_centre_3d_y_std_lag_3', u'rssi_Upstairs_AP_median_lag_3', u'video_room_centre_3d_y_max', u'acceleration_z_median_lagdiff', u'video_room_centre_3d_x_mean_lag_9', u'video_room_centre_3d_x_mean_lag_8', u'video_room_centre_3d_x_mean_lag_5', u'video_room_centre_3d_x_mean_lag_4', u'video_room_centre_3d_x_mean_lag_7', u'video_room_centre_3d_x_mean_lag_6', u'video_room_centre_3d_x_mean_lag_1', u'video_room_centre_3d_x_mean_lag_3', u'video_room_centre_3d_x_mean_lag_2', u'rssi_Kitchen_AP_max', u'video_room_bb_2d_tl_y_median', u'rssi_Study_AP_mean_lag_9', u'rssi_Study_AP_mean_lag_8', u'rssi_Study_AP_mean_lag_7', u'rssi_Study_AP_mean_lag_6', u'rssi_Study_AP_mean_lag_5', u'rssi_Study_AP_mean_lag_4', u'rssi_Study_AP_mean_lag_3', u'rssi_Study_AP_mean_lag_2', u'rssi_Study_AP_mean_lag_1', u'rssi_Lounge_AP_median_bool', u'video_room_bb_3d_flt_z_mean_lag_9', u'video_room_bb_3d_flt_z_mean_lag_8', u'video_room_bb_3d_flt_z_mean_lag_3', u'video_room_bb_3d_flt_z_mean_lag_2', u'video_room_bb_3d_flt_z_mean_lag_1', u'video_room_bb_3d_flt_z_mean_lag_7', u'video_room_bb_3d_flt_z_mean_lag_6', u'video_room_bb_3d_flt_z_mean_lag_5', u'video_room_bb_3d_flt_z_mean_lag_4', u'video_room_bb_3d_flt_y_min_lag_4', u'video_room_bb_3d_flt_y_min_lag_5', u'video_room_bb_3d_flt_y_min_lag_6', u'rssi_Study_AP_std_lag_8', u'video_room_bb_3d_flt_x_min_lag_4', u'video_room_bb_3d_flt_x_min_lag_7', u'video_room_bb_3d_flt_x_min_lag_6', u'video_room_bb_3d_flt_x_min_lag_1', u'video_room_bb_3d_flt_x_min_lag_3', u'video_room_bb_3d_flt_x_min_lag_2', u'rssi_Study_AP_std_lag_1', u'rssi_Study_AP_std_lag_2', u'rssi_Study_AP_std_lag_3', u'rssi_Study_AP_std_lag_4', u'rssi_Study_AP_std_lag_5', u'rssi_Study_AP_std_lag_6', u'rssi_Study_AP_std_lag_7', u'probability_of_value_bed1_lag_10', u'video_room_bb_3d_flt_y_min_lag_3', u'video_room_bb_2d_tl_x_max', u'video_room_centre_2d_y_std_lag_8', u'video_room_bb_3d_brb_x_min_lag_8', u'rssi_Study_AP_std', u'acceleration_z_median_lagdiff_lagdiff', u'video_room_bb_3d_brb_z_median_lag_10', u'video_room_bb_3d_flt_y_min_lag_8', u'video_room_bb_3d_flt_y_min_lag_9', u'probability_of_value_living_lag_8', u'probability_of_value_living_lag_9', u'probability_of_value_living_lag_6', u'probability_of_value_living_lag_7', u'probability_of_value_living_lag_4', u'probability_of_value_living_lag_5', u'probability_of_value_living_lag_2', u'probability_of_value_living_lag_3', u'video_room_bb_3d_flt_y_min_lag_2', u'probability_of_value_living_lag_1', u'video_room_centre_2d_y_std_lag_3', u'video_room_bb_3d_brb_x_min_lag_5', u'video_room_centre_2d_y_std_lag_5', u'video_room_bb_3d_brb_x_min_lag_7', u'rssi_Kitchen_AP_std', u'video_room_centre_2d_y_std_lag_7', u'video_room_centre_3d_z_std_lag_10', u'video_room_bb_2d_br_y_min_lag_8', u'video_room_bb_2d_br_y_min_lag_9', u'rssi_Kitchen_AP_median_lag_10', u'video_room_bb_2d_br_y_min_lag_2', u'video_room_bb_2d_br_y_min_lag_3', u'video_room_bb_2d_br_y_min_lag_1', u'video_room_bb_2d_br_y_min_lag_6', u'video_room_bb_2d_br_y_min_lag_7', u'video_room_bb_2d_br_y_min_lag_4', u'video_room_bb_2d_br_y_min_lag_5', u'video_room_bb_3d_brb_x_min_lag_9', u'video_room_centre_3d_y_max_lag_10', u'video_room_bb_3d_brb_x_std_lag_8', u'video_room_bb_3d_brb_x_std_lag_9', u'video_room_bb_3d_brb_x_std_lag_2', u'probability_of_value_hall_bas_lag_9', u'video_room_bb_3d_brb_x_std_lag_1', u'video_room_bb_3d_brb_x_std_lag_6', u'video_room_bb_3d_brb_x_std_lag_7', u'video_room_bb_3d_brb_x_std_lag_4', u'video_room_bb_3d_brb_x_std_lag_5', u'video_room_centre_3d_x_mean_lag_10', u'video_room_bb_2d_tl_y_std', u'video_room_bb_3d_brb_z_min', u'rssi_Upstairs_AP_std', u'rssi_Kitchen_AP_mean_lag_8', u'rssi_Kitchen_AP_mean_lag_9', u'rssi_Kitchen_AP_mean_lag_6', u'rssi_Kitchen_AP_mean_lag_7', u'rssi_Kitchen_AP_mean_lag_4', u'rssi_Kitchen_AP_mean_lag_5', u'rssi_Kitchen_AP_mean_lag_2', u'rssi_Kitchen_AP_mean_lag_3', u'rssi_Kitchen_AP_mean_lag_1', u'video_room_centre_2d_x_length_lag_5', u'video_room_centre_3d_x_mean', u'video_room_centre_3d_z_mean_lagdiff_lagdiff', u'video_room_centre_2d_x_length_lag_7', u'acceleration_room_centre_3d_horizontal', u'rssi_Upstairs_AP_std_lag_10', u'video_room_centre_2d_y_mean_lag_2', u'rssi_Lounge_AP_mean_lag_10', u'video_room_centre_2d_y_mean_lag_10', u'video_room_centre_2d_x_length_lag_1', u'video_room_bb_3d_brb_x_std_lag_3', u'video_room_centre_3d_x_max_lag_10', u'video_room_lag_5', u'video_room_lag_4', u'video_room_lag_7', u'video_room_lag_6', u'video_room_lag_1', u'video_room_lag_3', u'video_room_lag_2', u'video_room_lag_9', u'video_room_lag_8', u'acceleration_y_median_lagdiff', u'acceleration_y_median_lag_10', u'rssi_Lounge_AP_median', u'video_room_centre_2d_y_length_lagdiff', u'video_room_centre_3d_y_mean', u'rssi_Study_AP_max_lag_9', u'rssi_Study_AP_max_lag_8', u'rssi_Study_AP_max_lag_5', u'rssi_Study_AP_max_lag_4', u'rssi_Study_AP_max_lag_7', u'rssi_Study_AP_max_lag_6', u'rssi_Study_AP_max_lag_1', u'rssi_Study_AP_max_lag_3', u'rssi_Study_AP_max_lag_2', u'video_room_bb_2d_br_x_min_lag_7', u'video_room_bb_3d_flt_y_median', u'video_room_bb_2d_br_x_min_lag_6', u'acceleration_x_median_lag_9', u'acceleration_x_median_lag_8', u'acceleration_x_median_lag_5', u'acceleration_x_median_lag_4', u'acceleration_x_median_lag_7', u'acceleration_x_median_lag_6', u'acceleration_x_median_lag_1', u'acceleration_x_median_lag_3', u'acceleration_x_median_lag_2', u'video_room_centre_2d_x_median_lag_9', u'video_room_bb_2d_br_x_mean_lag_10', u'video_room_centre_2d_x_median_lag_7', u'video_room_centre_2d_x_median_lag_6', u'video_room_centre_2d_x_median_lag_5', u'video_room_centre_2d_x_median_lag_4', u'video_room_centre_2d_x_median_lag_3', u'video_room_centre_2d_x_median_lag_2', u'video_room_centre_2d_x_median_lag_1', u'speed_room_centre_3d_vertical', u'video_room_centre_2d_y_min_lag_10', u'video_room_bb_2d_tl_y_std_lag_10', u'room_angle_turn_x_lagdiff', u'video_room_bb_3d_brb_x_median', u'acceleration_z_min_lag_8', u'acceleration_z_min_lag_9', u'acceleration_x_max_lag_8', u'acceleration_x_max_lag_9', u'acceleration_x_max_lag_6', u'acceleration_x_max_lag_7', u'acceleration_x_max_lag_4', u'acceleration_x_max_lag_5', u'acceleration_x_max_lag_2', u'acceleration_x_max_lag_3', u'acceleration_z_min_lag_4', u'acceleration_x_max_lag_1', u'probability_of_value_toilet', u'video_room_bb_3d_brb_y_length', u'acceleration_x_max_lag_10', u'probability_of_value_bed2_lag_6', u'video_room_bb_3d_brb_z_max_lag_10', u'video_room_bb_3d_brb_z_mean_lag_9', u'video_room_bb_3d_brb_z_mean_lag_8', u'video_room_bb_3d_brb_z_mean_lag_7', u'video_room_bb_3d_brb_z_mean_lag_6', u'video_room_bb_3d_brb_z_mean_lag_5', u'video_room_bb_3d_brb_z_mean_lag_4', u'video_room_bb_3d_brb_z_mean_lag_3', u'video_room_bb_3d_brb_z_mean_lag_2', u'video_room_bb_3d_brb_z_mean_lag_1', u'video_room_bb_2d_tl_y_mean_lag_7', u'rssi_Upstairs_AP_median_bool', u'video_room_bb_2d_tl_y_mean_lag_1', u'probability_of_value_bed2', u'probability_of_value_bed1', u'video_room_bb_2d_tl_y_mean_lag_3', u'rssi_Study_AP_median_lag_1', u'rssi_Study_AP_median_lag_2', u'rssi_Study_AP_median_lag_3', u'rssi_Study_AP_median_lag_4', u'rssi_Study_AP_median_lag_5', u'rssi_Study_AP_median_lag_6', u'rssi_Study_AP_median_lag_7', u'rssi_Study_AP_median_lag_8', u'rssi_Study_AP_median_lag_9', u'probability_of_value_bed1_lag_9', u'probability_of_value_bed1_lag_8', u'probability_of_value_bed1_lag_5', u'probability_of_value_bed1_lag_4', u'probability_of_value_bed1_lag_7', u'probability_of_value_bed1_lag_6', u'probability_of_value_bed1_lag_1', u'probability_of_value_bed1_lag_3', u'probability_of_value_bed1_lag_2', u'video_room_bb_2d_br_y_mean', u'video_room_centre_3d_z_max', u'video_room_bb_2d_br_y_min_lag_10', u'video_room_bb_2d_tl_y_mean_lag_6', u'video_room_centre_3d_y_min_lag_1', u'video_room_centre_3d_y_min_lag_2', u'video_room_centre_3d_y_min_lag_3', u'video_room_centre_3d_y_min_lag_4', u'video_room_centre_3d_y_min_lag_5', u'video_room_centre_3d_y_min_lag_6', u'video_room_centre_3d_y_min_lag_7', u'video_room_centre_3d_y_min_lag_8', u'video_room_centre_3d_y_min_lag_9', u'video_room_bb_2d_tl_x_median', u'probability_of_value_toilet_lag_10', u'video_room_bb_3d_flt_y_median_lag_10', u'video_room_centre_3d_x_max_lag_9', u'video_room_centre_3d_x_max_lag_8', u'video_room_centre_3d_x_max_lag_3', u'video_room_centre_3d_x_max_lag_2', u'video_room_centre_3d_x_max_lag_1', u'video_room_centre_3d_x_max_lag_7', u'video_room_centre_3d_x_max_lag_6', u'video_room_centre_3d_x_max_lag_5', u'video_room_centre_3d_x_max_lag_4', u'video_room_bb_3d_brb_x_max_lag_9', u'video_room_bb_3d_brb_x_max_lag_8', u'video_room_bb_3d_brb_x_max_lag_3', u'video_room_bb_3d_brb_x_max_lag_2', u'video_room_bb_3d_brb_x_max_lag_1', u'video_room_bb_3d_brb_x_max_lag_7', u'video_room_bb_3d_brb_x_max_lag_6', u'video_room_bb_3d_flt_z_median', u'video_room_bb_3d_brb_x_max_lag_4', u'probability_of_value_hall_bas', u'probability_of_value_living', u'video_room_bb_2d_tl_y_min_lag_8', u'rssi_Lounge_AP_mean', u'video_room_centre_2d_y_max', u'video_room_centre_2d_x_mean_lag_8', u'video_room_bb_2d_tl_y_min_lag_6', u'video_room_centre_2d_x_mean_lag_1', u'video_room_centre_2d_x_mean_lag_2', u'video_room_centre_2d_x_mean_lag_3', u'video_room_centre_2d_x_mean_lag_4', u'video_room_centre_2d_x_mean_lag_5', u'video_room_centre_2d_x_mean_lag_6', u'video_room_centre_2d_x_mean_lag_7', u'rssi_Kitchen_AP_median_bool', u'video_room_bb_2d_tl_y_min_lag_7', u'video_room_bb_3d_brb_y_min_lag_10', u'video_room_bb_3d_brb_y_std_lag_9', u'video_room_bb_3d_brb_y_std_lag_8', u'acceleration_y_median_lagdiff_lagdiff', u'video_room_bb_3d_brb_y_std_lag_6', u'video_room_bb_3d_brb_y_std_lag_5', u'video_room_bb_3d_brb_y_std_lag_4', u'video_room_bb_3d_brb_y_std_lag_3', u'video_room_bb_3d_brb_y_std_lag_2', u'video_room_bb_3d_brb_y_std_lag_1', u'rssi_Study_AP_min', u'video_room_bb_2d_tl_y_min_lag_5', u'video_room_bb_3d_flt_z_min_lag_3', u'video_room_bb_3d_flt_z_min_lag_7', u'video_room_bb_3d_flt_z_min', u'rssi_Lounge_AP_mean_lag_9', u'rssi_Lounge_AP_mean_lag_8', u'video_room_bb_3d_brb_x_median_lag_10', u'video_room_bb_3d_flt_z_min_lag_5', u'video_room_bb_2d_tl_y_min_lag_3', u'rssi_Lounge_AP_mean_lag_3', u'rssi_Lounge_AP_mean_lag_2', u'rssi_Lounge_AP_mean_lag_1', u'video_room_bb_3d_flt_z_min_lag_4', u'rssi_Lounge_AP_mean_lag_7', u'rssi_Lounge_AP_mean_lag_6', u'rssi_Lounge_AP_mean_lag_5', u'rssi_Lounge_AP_mean_lag_4', u'video_room_bb_2d_tl_x_median_lag_3', u'probability_of_value_hall_haut', u'video_room_bb_3d_flt_z_std', u'video_room_bb_3d_flt_z_min_lag_9', u'video_room_bb_3d_flt_z_min_lag_8', u'video_room_bb_3d_brb_x_mean_lag_5', u'video_room_bb_3d_flt_z_mean_lag_10', u'acceleration_x_mean_lag_10', u'video_room_bb_3d_brb_x_max_lag_10', u'video_room_bb_2d_br_x_median_lag_6', u'video_room_bb_2d_br_x_min_lag_8', u'rssi_Upstairs_AP_std_lag_9', u'rssi_Upstairs_AP_std_lag_8', u'video_room_centre_3d_z_max_lag_10', u'video_room_bb_3d_brb_x_mean_lag_9', u'video_room_bb_3d_brb_x_mean_lag_8', u'probability_of_value_bed2_lag_10', u'video_room_bb_3d_brb_x_mean_lag_4', u'video_room_bb_3d_brb_x_mean_lag_7', u'video_room_bb_3d_brb_x_mean_lag_6', u'video_room_bb_3d_brb_x_mean_lag_1', u'video_room_bb_3d_brb_x_mean_lag_3', u'video_room_bb_3d_brb_x_mean_lag_2', u'video_room_bb_3d_brb_x_std', u'room_angle_turn_x_lagdiff_abs', u'video_room_centre_2d_x_std_lag_10', u'video_room_bb_3d_brb_y_mean_lag_10', u'video_room_bb_3d_brb_y_length_lagdiff', u'video_room_bb_2d_br_x_min_lag_10', u'video_room_centre_3d_y_std', u'rssi_Upstairs_AP_max_lag_8', u'rssi_Upstairs_AP_max_lag_9', u'rssi_Upstairs_AP_max_lag_2', u'rssi_Upstairs_AP_max_lag_3', u'rssi_Upstairs_AP_max_lag_1', u'rssi_Upstairs_AP_max_lag_6', u'rssi_Upstairs_AP_max_lag_7', u'rssi_Upstairs_AP_max_lag_4', u'rssi_Upstairs_AP_max_lag_5', u'video_room_bb_3d_flt_x_std_lag_6', u'video_room_bb_3d_flt_x_std_lag_7', u'video_room_bb_3d_flt_x_std_lag_4', u'video_room_bb_3d_flt_x_std_lag_5', u'video_room_bb_3d_flt_x_std_lag_2', u'video_room_bb_3d_flt_x_std_lag_3', u'video_room_bb_3d_flt_x_std_lag_1', u'video_room_bb_3d_flt_x_std_lag_8', u'video_room_bb_3d_flt_x_std_lag_9', u'video_room_centre_3d_y_max_lag_8', u'video_room_centre_3d_y_max_lag_9', u'video_room_centre_3d_y_max_lag_2', u'video_room_centre_3d_y_max_lag_3', u'video_room_centre_3d_y_max_lag_1', u'video_room_centre_3d_y_max_lag_6', u'video_room_centre_3d_y_max_lag_7', u'video_room_centre_3d_y_max_lag_4', u'video_room_centre_3d_y_max_lag_5', u'video_room_bb_2d_br_x_median', u'video_room_bb_3d_flt_x_min', u'video_room_centre_2d_y_median', u'video_room_bb_2d_tl_y_max', u'acceleration_z_std_lag_10', u'rssi_Kitchen_AP_mean_lag_10', u'video_room_centre_2d_x_max_lag_8', u'video_room_centre_2d_x_max_lag_9', u'video_room_centre_2d_x_max_lag_4', u'video_room_centre_2d_x_max_lag_5', u'video_room_centre_2d_x_max_lag_6', u'video_room_centre_2d_x_max_lag_7', u'video_room_centre_2d_x_max_lag_1', u'video_room_centre_2d_x_max_lag_2', u'video_room_centre_2d_x_max_lag_3', u'video_room_bb_2d_br_y_max', u'video_room_bb_2d_tl_x_max_lag_10', u'video_room_centre_3d_y_median_lag_9', u'video_room_centre_3d_y_median_lag_8', u'acceleration_z_std_lag_3', u'acceleration_z_std_lag_2', u'acceleration_z_std_lag_5', u'acceleration_z_std_lag_4', u'acceleration_z_std_lag_7', u'acceleration_z_std_lag_6', u'acceleration_z_std_lag_9', u'acceleration_z_std_lag_8', u'video_room_centre_3d_y_median_lag_3', u'video_room_centre_3d_y_median_lag_2', u'video_room_centre_3d_y_median_lag_5', u'video_room_centre_3d_y_median_lag_4', u'video_room_centre_3d_y_median_lag_7', u'video_room_centre_3d_y_median_lag_6', u'rssi_Lounge_AP_min_lag_3', u'rssi_Lounge_AP_min_lag_2', u'rssi_Lounge_AP_min_lag_1', u'rssi_Lounge_AP_min_lag_7', u'rssi_Lounge_AP_min_lag_6', u'rssi_Lounge_AP_min_lag_5', u'rssi_Lounge_AP_min_lag_4', u'rssi_Lounge_AP_min_lag_9', u'rssi_Lounge_AP_min_lag_8', u'video_room_centre_3d_z_median_lag_1', u'video_room_centre_3d_z_median_lag_2', u'video_room_centre_3d_z_median_lag_3', u'video_room_centre_3d_z_median_lag_4', u'video_room_centre_3d_z_median_lag_5', u'video_room_centre_3d_z_median_lag_6', u'video_room_centre_3d_z_median_lag_7', u'video_room_centre_3d_z_median_lag_8', u'video_room_centre_3d_z_median_lag_9', u'probability_of_value_study_lag_7', u'probability_of_value_study_lag_6', u'probability_of_value_study_lag_5', u'probability_of_value_study_lag_4', u'probability_of_value_study_lag_3', u'probability_of_value_study_lag_2', u'probability_of_value_study_lag_1', u'probability_of_value_study_lag_9', u'probability_of_value_study_lag_8', u'acceleration_x_std', u'probability_of_value_kitchen', u'rssi_Study_AP_max', u'rssi_Upstairs_AP_std_lag_5', u'probability_of_value_hall_bas_lag_5', u'probability_of_value_hall_bas_lag_4', u'probability_of_value_hall_bas_lag_7', u'probability_of_value_hall_bas_lag_6', u'probability_of_value_hall_bas_lag_1', u'video_room_centre_2d_x_length_lag_8', u'video_room_centre_3d_z_mean_lag_9', u'probability_of_value_hall_bas_lag_2', u'video_room_centre_3d_z_mean_lag_7', u'video_room_centre_3d_z_mean_lag_6', u'video_room_bb_2d_tl_y_min_lag_4', u'video_room_centre_2d_x_length_lag_6', u'video_room_bb_2d_tl_y_min_lag_2', u'video_room_centre_3d_z_mean_lag_2', u'video_room_centre_2d_x_length_lag_3', u'video_room_bb_2d_tl_y_min_lag_1', u'acceleration_z_max_lag_1', u'acceleration_z_max_lag_2', u'acceleration_z_max_lag_3', u'acceleration_z_max_lag_4', u'acceleration_z_max_lag_5', u'acceleration_z_max_lag_6', u'acceleration_z_max_lag_7', u'acceleration_z_max_lag_8', u'acceleration_z_max_lag_9', u'video_room_bb_3d_flt_x_max_lag_10', u'rssi_Upstairs_AP_mean_lag_10', u'video_room_centre_3d_x_min_lag_10', u'video_room_centre_3d_y_std_lag_10', u'video_room_bb_2d_tl_x_max_lag_9', u'video_room_bb_2d_tl_x_max_lag_8', u'video_room_bb_2d_tl_x_max_lag_5', u'video_room_bb_2d_tl_x_max_lag_4', u'video_room_bb_2d_tl_x_max_lag_7', u'video_room_bb_2d_tl_x_max_lag_6', u'video_room_bb_2d_tl_x_max_lag_1', u'video_room_bb_2d_tl_x_max_lag_3', u'video_room_bb_2d_tl_x_max_lag_2', u'video_room_bb_2d_br_x_min', u'rssi_Study_AP_max_lag_10', u'acceleration_z_max', u'video_room_centre_2d_x_median', u'video_room_bb_3d_flt_x_mean_lag_9', u'video_room_bb_3d_flt_x_mean_lag_8', u'video_room_bb_3d_flt_x_mean_lag_1', u'video_room_bb_3d_flt_x_mean_lag_3', u'video_room_bb_3d_flt_x_mean_lag_2', u'video_room_bb_3d_flt_x_mean_lag_5', u'video_room_bb_3d_flt_x_mean_lag_4', u'video_room_bb_3d_flt_x_mean_lag_7', u'video_room_bb_3d_flt_x_mean_lag_6', u'probability_of_value_stairs', u'video_room_bb_3d_flt_z_median_lag_4', u'video_room_bb_3d_flt_z_median_lag_5', u'video_room_bb_3d_flt_z_median_lag_6', u'video_room_bb_3d_flt_z_median_lag_7', u'video_room_bb_3d_flt_z_median_lag_1', u'video_room_bb_3d_flt_z_median_lag_2', u'video_room_bb_3d_flt_z_median_lag_3', u'video_room_bb_3d_flt_z_median_lag_8', u'video_room_bb_3d_flt_z_median_lag_9', u'video_room_bb_3d_flt_z_min_lag_10', u'acceleration_z_mean', u'video_room_bb_3d_brb_z_mean_lag_10', u'video_room_bb_3d_brb_z_max_lag_9', u'video_room_bb_3d_brb_z_max_lag_8', u'video_room_bb_3d_brb_z_max_lag_5', u'video_room_bb_3d_brb_z_max_lag_4', u'video_room_bb_3d_brb_z_max_lag_7', u'video_room_bb_3d_brb_z_max_lag_6', u'video_room_bb_3d_brb_z_max_lag_1', u'video_room_bb_3d_brb_z_max_lag_3', u'video_room_bb_3d_brb_z_max_lag_2', u'acceleration_y_max_lag_10', u'video_room_bb_3d_brb_x_mean_lag_10', u'room_angle_turn_x', u'video_room_centre_2d_y_median_lag_1', u'video_room_centre_2d_y_median_lag_2', u'video_room_centre_2d_y_median_lag_3', u'video_room_centre_2d_y_median_lag_4', u'video_room_centre_2d_y_median_lag_5', u'video_room_centre_2d_y_median_lag_6', u'video_room_centre_2d_y_median_lag_7', u'video_room_centre_2d_y_median_lag_8', u'video_room_centre_2d_y_median_lag_9', u'pir_lag_10', u'video_room_bb_2d_br_y_max_lag_10', u'video_room_centre_3d_x_median_lag_2', u'video_room_centre_3d_x_median_lag_3', u'video_room_centre_3d_x_median_lag_1', u'video_room_centre_3d_x_median_lag_6', u'video_room_centre_3d_x_median_lag_7', u'video_room_centre_3d_x_median_lag_4', u'video_room_centre_3d_x_median_lag_5', u'video_room_centre_3d_x_median_lag_8', u'video_room_centre_3d_x_median_lag_9', u'video_room_centre_3d_y_mean_lagdiff', u'video_room_bb_2d_br_x_mean', u'video_room_centre_2d_y_min_lag_7', u'video_room_centre_2d_y_min_lag_6', u'video_room_centre_2d_y_min_lag_5', u'video_room_centre_2d_y_min_lag_4', u'video_room_centre_2d_y_min_lag_3', u'video_room_centre_2d_y_min_lag_2', u'video_room_centre_2d_y_min_lag_1', u'video_room_centre_2d_y_min_lag_9', u'video_room_centre_2d_y_min_lag_8', u'video_room_centre_3d_y_median', u'video_room_bb_2d_tl_x_mean_lag_9', u'video_room_bb_2d_tl_x_mean_lag_8', u'video_room_bb_2d_tl_x_mean_lag_7', u'video_room_bb_2d_tl_x_mean_lag_6', u'video_room_bb_2d_tl_x_mean_lag_5', u'video_room_bb_2d_tl_x_mean_lag_4', u'video_room_bb_2d_tl_x_mean_lag_3', u'video_room_bb_2d_tl_x_mean_lag_2', u'video_room_bb_2d_tl_x_mean_lag_1', u'video_room_centre_3d_y_mean_lag_10', u'video_room_centre_2d_y_std_lag_9', u'probability_of_value_hall_haut_lag_9', u'video_room_bb_3d_brb_x_min_lag_1', u'video_room_centre_2d_y_std_lag_1', u'video_room_bb_3d_brb_x_min_lag_3', u'video_room_bb_3d_brb_x_min_lag_2', u'video_room_centre_2d_y_std_lag_4', u'video_room_bb_3d_brb_x_min_lag_4', u'video_room_centre_2d_y_std_lag_6', u'video_room_bb_3d_brb_x_min_lag_6', u'probability_of_value_hall_haut_lag_2', u'probability_of_value_hall_haut_lag_3', u'video_room_bb_3d_flt_y_mean_lag_10', u'video_room_centre_3d_y_mean_lagdiff_lagdiff', u'rssi_Upstairs_AP_min_lag_1', u'rssi_Upstairs_AP_min_lag_2', u'rssi_Upstairs_AP_min_lag_3', u'rssi_Upstairs_AP_min_lag_4', u'rssi_Upstairs_AP_min_lag_5', u'rssi_Upstairs_AP_min_lag_6', u'rssi_Upstairs_AP_min_lag_7', u'rssi_Upstairs_AP_min_lag_8', u'rssi_Upstairs_AP_min_lag_9', u'video_room_centre_2d_y_length_lag_6', u'video_room_centre_2d_y_length_lag_7', u'video_room_centre_2d_y_length_lag_4', u'video_room_centre_2d_y_length_lag_5', u'video_room_centre_2d_y_length_lag_2', u'video_room_centre_2d_y_length_lag_3', u'video_room_centre_2d_y_length_lag_1', u'video_room_centre_2d_y_length_lag_8', u'video_room_centre_2d_y_length_lag_9', u'video_room_bb_3d_flt_z_max_lag_10', u'rssi_Lounge_AP_std', u'probability_of_value_toilet_lag_6', u'probability_of_value_toilet_lag_7', u'probability_of_value_toilet_lag_4', u'probability_of_value_toilet_lag_5', u'probability_of_value_toilet_lag_2', u'probability_of_value_toilet_lag_3', u'rssi_Upstairs_AP_min', u'probability_of_value_toilet_lag_1', u'video_room_bb_3d_brb_x_max', u'probability_of_value_toilet_lag_8', u'probability_of_value_toilet_lag_9', u'video_room_bb_3d_flt_y_min', u'video_room_centre_2d_y_std', u'video_room_bb_3d_brb_y_min', u'video_room_centre_3d_z_mean_lag_8', u'acceleration_y_mean_lag_10', u'video_room_bb_2d_tl_y_max_lag_8', u'video_room_bb_2d_tl_y_max_lag_9', u'video_room_bb_2d_tl_y_max_lag_4', u'video_room_bb_2d_tl_y_max_lag_5', u'video_room_bb_2d_tl_y_max_lag_6', u'video_room_bb_2d_tl_y_max_lag_7', u'video_room_bb_2d_tl_y_max_lag_1', u'video_room_bb_2d_tl_y_max_lag_2', u'video_room_bb_2d_tl_y_max_lag_3', u'acceleration_y_max', u'pir', u'video_room_bb_3d_flt_z_max_lag_1', u'video_room_bb_3d_flt_z_max_lag_3', u'video_room_bb_3d_flt_z_max_lag_2', u'video_room_bb_3d_flt_z_max_lag_5', u'video_room_bb_3d_flt_z_max_lag_4', u'video_room_bb_3d_flt_z_max_lag_7', u'video_room_bb_3d_flt_z_max_lag_6', u'video_room_bb_3d_flt_z_max_lag_9', u'video_room_bb_3d_flt_z_max_lag_8', u'rssi_Upstairs_AP_mean', u'rssi_Kitchen_AP_max_lag_8', u'rssi_Kitchen_AP_max_lag_9', u'rssi_Kitchen_AP_max_lag_2', u'rssi_Kitchen_AP_max_lag_3', u'rssi_Kitchen_AP_max_lag_1', u'rssi_Kitchen_AP_max_lag_6', u'rssi_Kitchen_AP_max_lag_7', u'rssi_Kitchen_AP_max_lag_4', u'rssi_Kitchen_AP_max_lag_5', u'video_room_centre_3d_y_min', u'acceleration_y_std_lag_10']
columns_to_keep_lead = [col for col in dtrain.columns if 'lead' in col]
columns_to_keep = columns_to_keep + columns_to_keep_lead

# Restrict ml_dataset to the features that will be used by xgboost
ml_dataset = dtrain[columns_to_keep]
# Keep some useful info
answer_for_crossval = dtrain[columns_target]
cv_df = dtrain[['original_dataset']]  
                   
# Map the target variable             
target_map={}
for index,columns_name in enumerate(columns_target,start=0):
    target_map[columns_name]=index    
ml_dataset['__target__'] = ml_dataset['target'].map(str).map(target_map)
del ml_dataset['target']

# Remove rows for which the target is unknown.
indices = ~ml_dataset['__target__'].isnull()
ml_dataset = ml_dataset[indices]
ml_dataset = ml_dataset.reset_index(drop=True)
answer_for_crossval = answer_for_crossval[indices]
cv_df = cv_df[indices]
answer_for_crossval = answer_for_crossval.reset_index(drop=True)
cv_df = cv_df.reset_index(drop=True)             
save(answer_for_crossval, "answer_for_crossval")
save(cv_df, "cv_df")
                      
# Fill missing values of ml_dataset
ml_dataset = ml_dataset.fillna(-99999.0)

# Dummifiy certain variables of ml_dataset
LIMIT_DUMMIES = 100
categorical_to_dummy_encode = [u'rssi_Study_AP_median_bool', u'pir_lag_1', u'pir_lag_2', u'pir_lag_3', u'pir_lag_4', u'pir_lag_5', u'pir_lag_6', u'pir_lag_7', u'pir_lag_8', u'pir_lag_9', u'video_room', u'video_room_lag_10', u'rssi_Lounge_AP_median_bool', u'video_room_lag_5', u'video_room_lag_4', u'video_room_lag_7', u'video_room_lag_6', u'video_room_lag_1', u'video_room_lag_3', u'video_room_lag_2', u'video_room_lag_9', u'video_room_lag_8', u'rssi_Upstairs_AP_median_bool', u'rssi_Kitchen_AP_median_bool', u'pir_lag_10', u'pir',u'pir_lead_1', u'pir_lead_2', u'pir_lead_3', u'pir_lead_4', u'pir_lead_5', u'pir_lead_6', u'pir_lead_7', u'pir_lead_8', u'pir_lead_9', u'video_room_lead_10',  u'video_room_lead_5', u'video_room_lead_4', u'video_room_lead_7', u'video_room_lead_6', u'video_room_lead_1', u'video_room_lead_3', u'video_room_lead_2', u'video_room_lead_9', u'video_room_lead_8',u'pir_lead_10']
def select_dummy_values(ml_dataset, features):
    dummy_values = {}
    for feature in categorical_to_dummy_encode:
        values = [
            value
            for (value, _) in Counter(ml_dataset[feature]).most_common(LIMIT_DUMMIES)
        ]
        dummy_values[feature] = values
    return dummy_values
DUMMY_VALUES = select_dummy_values(ml_dataset, categorical_to_dummy_encode)
def dummy_encode_dataframe(df):
    for (feature, dummy_values) in DUMMY_VALUES.items():
        for dummy_value in dummy_values:
            dummy_name = u'%s_value_%s' % (feature, unicode(dummy_value))
            df[dummy_name] = (df[feature] == dummy_value).astype(float)
        del df[feature]
        print 'Dummy-encoded feature %s' % feature
dummy_encode_dataframe(ml_dataset)

# Split ml_dataset between the features (X) and target variable (Y)
X = ml_dataset.drop('__target__', axis=1)  
Y = ml_dataset['__target__']               

# Apply the same preparation to the test
ml_dataset_test = dtest
columns_to_keep.remove('target')
start_df = ml_dataset_test['start']
end_df = ml_dataset_test['end']
record_id_df = ml_dataset_test['record_id']
ml_dataset_test = ml_dataset_test[columns_to_keep]
                   
ml_dataset_test = ml_dataset_test.fillna(-99999.0)

DUMMY_VALUES = select_dummy_values(ml_dataset_test, categorical_to_dummy_encode)
dummy_encode_dataframe(ml_dataset_test)
                   
##################################################### End preparation of dtrain and dtest


##################################################### Start Blending
print "Starting Blending Procedure"
#Initial Data Splitting
X_dev = X
Y_dev = Y

X_test = ml_dataset_test

n_class = 20 #number of classes here

#Cross-validation strategy
#skf = list(KFold(len(Y_dev), n_folds)) #just the list of indexes of the kfold

def cross_val_id(x,y):
    valid_vals = [x,y]
    test = cv_df[cv_df["original_dataset"].isin(valid_vals)].index
    train = cv_df[-cv_df["original_dataset"].isin(valid_vals)].index                      
    return (train, test)
    


skf_id = []

"""
skf_id.append(cross_val_id(6,10))    
skf_id.append(cross_val_id(5,9)) 
skf_id.append(cross_val_id(4,8)) 
skf_id.append(cross_val_id(3,7)) 
skf_id.append(cross_val_id(2,1)) 
"""
skf_id.append(cross_val_id(2,10))    
skf_id.append(cross_val_id(6,9)) 
skf_id.append(cross_val_id(5,8)) 
skf_id.append(cross_val_id(4,7)) 
skf_id.append(cross_val_id(3,1)) 


def datasets_level2():
    ''' Initialize the train and test datasets for the level-2 learners
        -- only need the initial dataset X_dev, X_test, the number of base learners, the number of classes n_class --
    '''
    blend_train = np.zeros((X_dev.shape[0], len(clfs)*n_class)) # Number of training data x (Number of classifiers * Number of class)
    blend_test = np.zeros((X_test.shape[0], len(clfs)*n_class)) # Number of testing data x (Number of classifiers * Number of class)

    base_learner_names = ["learner_"+str(x) for x in range(len(clfs))]
    base_learners_names_class = [ str(i[0])+"_"+str(i[1]) for i in itertools.product(base_learner_names,range(n_class))]

    dblend_train = pd.DataFrame(blend_train, columns = base_learners_names_class)
    dblend_test = pd.DataFrame(blend_test, columns = base_learners_names_class)
    
    print "Returning the initialised train and test datasets for level2 learning"
    return dblend_train, dblend_test

dblend_train, dblend_test = datasets_level2()

base_learner_names = ["learner_"+str(x) for x in range(len(clfs))]
base_learners_names_class = [ str(i[0])+"_"+str(i[1]) for i in itertools.product(base_learner_names,range(n_class))]

print "-----"
print "base_learners_names_class", len(base_learners_names_class)
print "-----"
print base_learners_names_class


def base_learners_fitting(clfs, skf):
    ''' Returns the train and test datasets for the level-2 learners'''
    
    #dblend_train, dblend_test = datasets_level2()
    
    # For each classifier, we train the number of fold times (=len(skf))
    k_fold_names = ["fold_" + str(x) for x in range(len(skf))]
    
    for j, clf in enumerate(clfs):
        print 'Training classifier [%s]' % (j)
        #Initializing a test dataset for j-th learner
        blend_test_j = np.zeros((X_test.shape[0], len(skf)*n_class))
        blend_test_j_columns = [i[0]+"_"+str(i[1]) for i in itertools.product(k_fold_names,range(n_class))]
        dblend_test_j= pd.DataFrame(blend_test_j,columns = blend_test_j_columns) # Number of testing data x (Number of folds x Number of class) , we will take the mean of the predictions later
        
        for i, (train_index, cv_index) in enumerate(skf):
            print 'Fold [%s]' % (i)
        
            # This is the training and validation set
            #X_train = X_dev.ix[train_index]
            #Y_train = Y_dev.ix[train_index]
            #X_valid = X_dev.ix[cv_index]
            #Y_valid = Y_dev.ix[cv_index]
            
            X_train = X_dev.loc[train_index]
            Y_train = Y_dev.loc[train_index]
            X_valid = X_dev.loc[cv_index]
            Y_valid = Y_dev.loc[cv_index]
            
            col = list(X_valid.columns)
            sorted(col)
            
            print "Fitting the model !"
            clf.fit(X_train[col], Y_train) 
            
            Y_test_predict = clf.predict(X_valid[col])          
            score = metrics.accuracy_score(Y_valid, Y_test_predict)   
            print "Accuracy on the {}-th fold: {}".format(i, score)
            
            # This output will be the basis for our blended classifier to train against,
            # which is also the output of our classifiers
            #columns_learner_j = [x for x in base_learners_names_class if x[8] == str(j)]
            columns_learner_j = ["learner_"+str(j) +"_"+ str(x) for x in range(n_class)]
            print len(columns_learner_j)
            
            dblend_train.ix[cv_index, columns_learner_j] = clf.predict_proba(X_valid[col])
            
            columns_learner_j_test = [x for x in blend_test_j_columns if x[5] == str(i)]  
            dblend_test_j[columns_learner_j_test] = clf.predict_proba(X_test[col])

        #Transforming to a nicer format and averaging the proba of each class per folds
        dblend_test_j.columns = pd.MultiIndex.from_tuples([tuple(c.split('_')) for c in dblend_test_j.columns])
        col_20 = [str(x) for x in range(20)]
        dblend_test_j = dblend_test_j.stack(0).stack(0).reset_index().groupby('level_0')[col_20].mean()
        dblend_test_j.rename(columns = {x: "learner_" +str(j)+"_"+x for x in col_20},inplace = True) #It's the dataset for the j-learner with columns the probas for each class
        
        #Putting this in the final test dataset 
        dblend_test.ix[:,dblend_test_j.columns] = dblend_test_j
    
    print "Returning and Saving the train and test datasets for level-2 learning"
    save_dataframe(dblend_train,"dblend_train_batch1")
    save_dataframe(dblend_test,"dblend_test_batch1")
    save_dataframe(Y_dev,"Y_dev")
    
    return dblend_train, dblend_test

def level2_learning(clf_level2 = LogisticRegression(), name = 'clf_level2'):
    ''' Fit and Score the level2 learner'''
    dblend_train, dblend_test = base_learners_fitting(clfs, skf_id)
    
    #Fitting level-2 learner here
    clf_level2.fit(dblend_train, Y_dev)
    
    print "Saving {} in the folder".format(name)
    save(clf_level2, name)
    print "Learner of level 2 is now saved !"
    
    # Predict now
    Y_test_predict = clf_level2.predict_proba(dblend_test)
    
    print "Y_test_predict"
    
    #Maxime's post process: POUR AVOIR LES BONNES COLONNES A L'ISSUE DE LA PREDICTION
    probabilities = pd.DataFrame(data= Y_test_predict, index=ml_dataset_test.index, columns=columns_target)
    end_df_temp = pd.DataFrame(data=end_df, index=ml_dataset_test.index)
    start_df_temp = pd.DataFrame(data=start_df, index=ml_dataset_test.index)
    record_id_df_temp = pd.DataFrame(data=record_id_df, index=ml_dataset_test.index)

    # Build scored dataset
    results_test = record_id_df_temp.join(start_df_temp, how='left')
    results_test = results_test.join(end_df_temp, how='left')
    results_test = results_test.join(probabilities, how='left')

    return results_test


# Recipe outputs
output_path = os.path.join(os.path.dirname(os.path.dirname(os.path.dirname(__file__))), 'models/stacked_scored.csv')
level2_learning().to_csv(path_or_buf = output_path , header = True, index = False, encoding='utf-8')
